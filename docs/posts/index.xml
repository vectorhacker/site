<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Posts on Victor&#39;s Blog</title>
        <link>https://victoramartinez.com/posts/</link>
        <description>Recent content in Posts on Victor&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en</language>
        <copyright>Victor Martínez</copyright>
        <lastBuildDate>Sun, 15 Jun 2025 19:39:41 -0400</lastBuildDate>
        <atom:link href="https://victoramartinez.com/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>Why Claude&#39;s Comment Paper Is a Poor Rebuttal</title>
            <link>https://victoramartinez.com/posts/why-claudes-comment-paper-is-a-poor-rebuttal/</link>
            <pubDate>Sun, 15 Jun 2025 19:39:41 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/why-claudes-comment-paper-is-a-poor-rebuttal/</guid>
            <description>&lt;p&gt;Recently Apple &lt;a href=&#34;https://machinelearning.apple.com/research/illusion-of-thinking&#34;&gt;published a paper&lt;/a&gt; on LRMs (Large Reasoning Models) and how they found that &amp;ldquo;that LRMs have limitations in exact computation&amp;rdquo; and that &amp;ldquo;they fail to use explicit algorithms and reason inconsistently across puzzles.&amp;rdquo; I would consider this a death blow paper to the current push for using LLMs and LRMs as the basis for AGI. Subbaro Kambhampati and Yann LeCun seem to agree. You could say that the paper &lt;a href=&#34;https://garymarcus.substack.com/p/a-knockout-blow-for-llms&#34;&gt;knocked out LLMs&lt;/a&gt;. More recently, a comment paper showed up on Arxiv and shared around twitter as a rebuttal to Apple&amp;rsquo;s paper. Putting aside the stunt of having Claude Opus as a co-author (yes, I&amp;rsquo;m not kidding), the paper in itself is a poor rebuttal for many reasons which we shall explore, but mainly for missing the entire point of the paper and prior research by AI researchers such as Professor &lt;a href=&#34;https://cotopaxi.eas.asu.edu/&#34;&gt;Kambhampati&lt;/a&gt;.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>Recently Apple <a href="https://machinelearning.apple.com/research/illusion-of-thinking">published a paper</a> on LRMs (Large Reasoning Models) and how they found that &ldquo;that LRMs have limitations in exact computation&rdquo; and that &ldquo;they fail to use explicit algorithms and reason inconsistently across puzzles.&rdquo; I would consider this a death blow paper to the current push for using LLMs and LRMs as the basis for AGI. Subbaro Kambhampati and Yann LeCun seem to agree. You could say that the paper <a href="https://garymarcus.substack.com/p/a-knockout-blow-for-llms">knocked out LLMs</a>. More recently, a comment paper showed up on Arxiv and shared around twitter as a rebuttal to Apple&rsquo;s paper. Putting aside the stunt of having Claude Opus as a co-author (yes, I&rsquo;m not kidding), the paper in itself is a poor rebuttal for many reasons which we shall explore, but mainly for missing the entire point of the paper and prior research by AI researchers such as Professor <a href="https://cotopaxi.eas.asu.edu/">Kambhampati</a>.</p>
<h2 id="mathematical-errors">Mathematical Errors</h2>
<p>Firstly the paper makes some <em>key</em> mathematical errors. As <a href="https://x.com/BlackHC">Andreas Kirsch</a> points out on X, it makes the claim that token growth is predicted by the following:</p>
$$
T(N) \approx 5(2^N - 1)^2 + C
$$<p>namely, it predicts a quadratic token growth for solutions of <a href="https://en.wikipedia.org/wiki/Tower_of_Hanoi">Towers of Hanoi</a>. The reality is that the growth of tokens is linear regardless of the number of steps required to solve. In fact, Gemini 2.5 Pro outputs a solution in under 10k tokens for \(n=10\) discs.</p>
<p>See Andreas&rsquo;s post on X:</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Some comment on this note on arXiv:<br><br>1. Unlike <a href="https://twitter.com/scaling01?ref_src=twsrc%5Etfw">@scaling01</a>, this comment claims that the required number of tokens increases in the square of the number of steps. This is not true.<br>The original lower bound estimate was linear because that is the minimum number of tokens that need… <a href="https://t.co/8bcSp1s28f">https://t.co/8bcSp1s28f</a> <a href="https://t.co/RcC398ScPp">pic.twitter.com/RcC398ScPp</a></p>&mdash; Andreas Kirsch 🇺🇦 (@BlackHC) <a href="https://twitter.com/BlackHC/status/1933442363197706658?ref_src=twsrc%5Etfw">June 13, 2025</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<h2 id="confused-between-mechanical-execution-and-reasoning-complexity">Confused Between Mechanical Execution and Reasoning Complexity</h2>
<p>The rebuttal conflates solution length with computational difficulty. As Kirsch points out, different puzzles have vastly different complexity profiles:</p>
<ul>
<li><strong>Tower of Hanoi</strong>: Requires \(2^N-1\) moves, but has branching factor 1 and requires no search - just mechanical execution with &ldquo;trivial \(O(1)\) decision process per move&rdquo;</li>
<li><strong>River Crossing</strong>: Requires ~4N moves, but has branching factor &gt;4 and is NP-hard, requiring complex constraint satisfaction and search</li>
</ul>
<p>This explains why models might execute 100+ Hanoi moves while failing on 5-move River Crossing problems - the latter requires genuine reasoning while the former is mechanical execution.</p>
<h2 id="contradictions">Contradictions</h2>
<p>The rebuttal paper&rsquo;s own data contradicts its thesis. Its own data shows that models can generate long sequences when they choose to, but in the findings of the original Apple paper, it finds that models <em>systematically</em> choose <strong>NOT</strong> to generate longer reasoning traces on harder problems, effectively just giving up. It&rsquo;s not explained why models would self-impose token limits that hurt their performance. In the original study&rsquo;s findings it says &ldquo;Despite operating well below their generation length limits with ample inference budget available, these models fail to take advantage of additional inference compute&rdquo; (Shojaee et al., p.8).</p>
<p>In the rebuttal&rsquo;s experiments it shows that it can &ldquo;Solve Tower of Hanoi with 15 disks. Output a Lua function that prints the solution when called. Results: Very high accuracy across tested models (Claude-3.7-Sonnet, Claude Opus 4, OpenAI o3, Google Gemini 2.5), completing in under 5,000 tokens&rdquo; (p.3) which directly contradicts its original claim that models are fundamentally constrained by token limits, because this proves that models ARE able to solve complex problems efficiently given appropriate output formats.</p>
<p>The claims in this rebuttal paper create a paradox. If models can solve hard problems efficiently, and models recognize when to truncate output, then why do they systematically choose inefficient approaches that lead to failure? This supports the original study&rsquo;s thesis about reasoning limitations, not the constraint thesis put forth in the rebuttal.</p>
<h2 id="completely-missing-the-point-and-narrow-focus">Completely Missing the Point and Narrow Focus</h2>
<p>The main point of Apple&rsquo;s paper was to identify systematic reasoning patterns, not evaluate accuracy. Indeed, they point out that reasoning benchmarks thus far have inherent limitations because of their leakiness and narrow focus on final solutions, rather than on the general process of reasoning.</p>
<blockquote>
<p>Reasoning models initially increase their thinking tokens proportionally with problem complexity. However, upon approaching a critical threshold—which closely corresponds to their accuracy collapse point—models counterintuitively begin to reduce their reasoning effort despite increasing problem difficulty&quot; (Shojaee et al., p.8)</p></blockquote>
<p>It instead completely ignores this finding and offers no explanation as to why models would systematically reduce computational effort when faced with harder problems. This suggests fundamental scaling limitations with current LRM architectures.</p>
<p>Further, the rebuttal does not address the Apple paper&rsquo;s complexity regime patterns that it identified consistently across models or even how token limits explain these.</p>
<h2 id="conclusions-and-further-reading">Conclusions and Further Reading</h2>
<p>Concluding, this comment paper fails to address the key findings of the original paper and focuses too narrowly on contradicting elements. It fundamentally misses the point of Apple&rsquo;s paper, and indeed other papers including by Subbaro Kambhampati, and most recently Georgia Tech, which identify <em>fundamental</em> limitations with current LLM architectures.</p>
<p>I suggest reading up further on <a href="https://scholar.google.com/scholar?hl=en&amp;as_sdt=0%2C5&amp;q=subbarao&#43;kambhampati&#43;reason&#43;llm&amp;btnG=">Kambhampati&rsquo;s research</a> into LLM reasoning to get a better idea of why LLM/LRMs are fundamentally limited in reasoning ability. Also read <a href="https://garymarcus.substack.com/p/llms-dont-do-formal-reasoning-and">Gary Marcus&rsquo;s blog</a> on Substack and the Georgia Tech paper <a href="https://arxiv.org/pdf/2506.07936">here</a>.</p>
]]></content>
        </item>
        
        <item>
            <title>The Limits of Current AI: A Skeptical Perspective on Autonomous Agents</title>
            <link>https://victoramartinez.com/posts/limits-of-current-ai/</link>
            <pubDate>Sun, 25 May 2025 21:11:50 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/limits-of-current-ai/</guid>
            <description>&lt;p&gt;I align with Yann LeCun&amp;rsquo;s camp on this matter. I don&amp;rsquo;t believe that LLMs and machine learning alone will lead us to human-level intelligence. Current models have demonstrated only very limited reasoning capabilities within specific domains—essentially following and recombining similar patterns they&amp;rsquo;ve ingested during training.&lt;/p&gt;
&lt;p&gt;If you follow computer scientist and AI researcher Subbarao Kambhampati, a professor at the School of Computing and Augmented Intelligence at ASU, he proposes and demonstrates that language models and reasoning models cannot plan effectively even in domains as simple as organizing blocks in a virtual world, let alone in more complex domains.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>I align with Yann LeCun&rsquo;s camp on this matter. I don&rsquo;t believe that LLMs and machine learning alone will lead us to human-level intelligence. Current models have demonstrated only very limited reasoning capabilities within specific domains—essentially following and recombining similar patterns they&rsquo;ve ingested during training.</p>
<p>If you follow computer scientist and AI researcher Subbarao Kambhampati, a professor at the School of Computing and Augmented Intelligence at ASU, he proposes and demonstrates that language models and reasoning models cannot plan effectively even in domains as simple as organizing blocks in a virtual world, let alone in more complex domains.</p>
<p>Given all of this, I would be highly skeptical that anyone could achieve a successful single-employee company using AI agents by 2026. The moment these systems encounter any non-trivial decision, they would likely fall apart completely.</p>
<p>Unless there&rsquo;s a dramatic shift in architecture—and this doesn&rsquo;t even account for the fact that the cost of running all operations in a simulated manner would equal or exceed the cost of hiring people for those positions. Consider, for example, that just a few minutes of coding with Claude Opus 4 in an IDE already costs several dollars to approximate the performance of a mediocre junior developer. Imagine the cost of running it nearly all day?</p>
<p>I don&rsquo;t know—it doesn&rsquo;t seem threatening to me.</p>
]]></content>
        </item>
        
        <item>
            <title>Software Engineers Are Safe... For Now</title>
            <link>https://victoramartinez.com/posts/software-engineers-are-safe-for-now/</link>
            <pubDate>Wed, 25 Dec 2024 00:00:00 +0000</pubDate>
            
            <guid>https://victoramartinez.com/posts/software-engineers-are-safe-for-now/</guid>
            <description>&lt;p&gt;Take a look at this search of jobs postings at OpenAI for December 25th, 2024. As of the time of this writing, over 150 results in all, 87 results for the term &amp;ldquo;Software Engineer.&amp;rdquo; This is a few days after the release of their latest frontier model, o3. This tells me that for the foreseeable future, Software Engineering jobs are safe, if not going to continue to be safe from full automation.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>Take a look at this search of jobs postings at OpenAI for December 25th, 2024. As of the time of this writing, over 150 results in all, 87 results for the term &ldquo;Software Engineer.&rdquo; This is a few days after the release of their latest frontier model, o3. This tells me that for the foreseeable future, Software Engineering jobs are safe, if not going to continue to be safe from full automation.</p>
<p><img src="/images/linkedin-job-posts-openai.png" alt="LinkedIn Job Postings for OpenAI Dec 25, 2024"></p>
<p>Many of these roles require several years of experience developing products, proficiency in programming languages and frameworks like JavaScript, React, and Python, standing up infrastructure, proficiency with SQL, and some interest in AI/ML. This tells me that not only are they still looking to hire people who are experts in their respective fields, but that human work is still favorable to machine&rsquo;s for at least the next several years.</p>
<p>Are these engineers using ChatGPT and AI coding assistants? Yes, absolutely, as is and will every other engineer in the near future! Does this mean they don&rsquo;t have be experts in the tech they&rsquo;re working on? Quite the contrary, if anything it means they need to be more deeply familiar with the tech, not less.</p>
<h2 id="cost-prohibitive">Cost Prohibitive</h2>
<p>There&rsquo;s evidence to suggest that while these advancements in reasoning models are amazing, they come at <a href="https://www.barrons.com/articles/openai-o3-model-cost-chatgpt-microsoft-ca040997">prohibitive cost, even for tech giants like Microsoft. </a> And so we may just be squeezing what&rsquo;s left out of the current generation of LLMs and are waiting for hardware to improve exponentially. For the time being, the addition of &ldquo;reasoning&rdquo; to these models, while improving outputs, adds time to the output, from seconds to minutes for complex questions. With regards to full compute models, it costs nearly $3500 per task and takes ~14 minutes to complete each one for the full-reasoning model on ARC-AGI.</p>
<p>What&rsquo;s more, is that the higher compute models are <a href="https://techcrunch.com/2024/12/23/openais-o3-suggests-ai-models-are-scaling-in-new-ways-but-so-are-the-costs/">making costs less predictable. </a> In all, o3 blows past other models in arc-agi at a cost of over $1000 per task, and that&rsquo;s at log scale. It&rsquo;s all to suggest that these models wouldn&rsquo;t be used to solve tasks that humans can do much more cheaply, even with the help of lesser ai assistants, such as programming and software engineering. No, these models will probably be let loose on problems of much higher import and where the cost of compute is no object or at least less of a barrier. Reason being, is feedback loops. Software engineering requires quick iterative feedback loops that could be lost when using these slower reasoning systems.</p>
<h2 id="humans-can-still-reason-faster">Humans Can Still Reason Faster</h2>
<p>While these models can allegedly beat human programmers in coding competitions and somewhat match humans in software engineering tasks according to <a href="https://www.swebench.com/">swe-bench</a>, for day to day tasks, humans still reason faster and with enough accuracy whilst still being much cheaper to maintain. For the same cost you could probably pay a couple or even 10s of humans to solve real world software engineering problems, get feedback faster, and get a product out faster. Now give an experienced human software engineer access to a coding assistant like copilot or editor like Cursor and they&rsquo;re flying.</p>
<h2 id="humans-still-generalize-and-adapt-better">Humans Still Generalize and Adapt Better</h2>
<p>While these models are impressive in their reasoning ability and that they can now adapt to some novel situations, there&rsquo;s <a href="https://machinelearning.apple.com/research/gsm-symbolic">evidence that they&rsquo;re brittle and very much dependent on the patterns they were trained on. </a> Not just failing, but dropping performance significantly, something a human that is sufficiently intelligent does not do. What&rsquo;s more, this drastic failure in performance <a href="https://arxiv.org/html/2412.11934v1">compounds on itself and lead these models to be extra vulnerable to reasoning chain attacks.</a> While you could argue that a human could compound their errors in a similar way, we&rsquo;d at least have a chance at recognizing out compounding errors early on especially in software engineering where you&rsquo;d only need to test something before shipping it to figure out if it doesn&rsquo;t work. With an llm you could potentially just trick it to not only give a wrong answer or software solutions, but have it think that it&rsquo;s doing okay.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Humans software engineers, for the time being, are safe. The day openai and other ai giants stop hiring new engineers, that&rsquo;s the day we should be worried. For now it&rsquo;s actually safer and cheaper to keep hiring human engineers. That&rsquo;s not to say that this will hold forever, but for the foreseeable future, this will hold. So you computer science majors about to graduate, or just starting, keep on trucking, you&rsquo;ll be fine for now.</p>
]]></content>
        </item>
        
        <item>
            <title>The Most Important Topics for a Computer Science Undergrad</title>
            <link>https://victoramartinez.com/posts/important-computer-science-concepts/</link>
            <pubDate>Sun, 22 Dec 2024 22:16:40 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/important-computer-science-concepts/</guid>
            <description>&lt;p&gt;As a computer science student, it&amp;rsquo;s essential to have a solid foundation in various topics to succeed in the field. In this post, we&amp;rsquo;ll cover the most critical topics for a computer science undergrad, in no particular order.&lt;/p&gt;
&lt;h2 id=&#34;maths&#34;&gt;&lt;strong&gt;Maths&lt;/strong&gt;&lt;/h2&gt;
&lt;h3 id=&#34;calculus&#34;&gt;Calculus&lt;/h3&gt;
&lt;p&gt;Calculus is a fundamental subject that helps understand many computer science concepts, such as optimization, machine learning, and differential equations. It&amp;rsquo;s essential to have a good grasp of limits, derivatives, basic integrals, and multi-variable calculus.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>As a computer science student, it&rsquo;s essential to have a solid foundation in various topics to succeed in the field. In this post, we&rsquo;ll cover the most critical topics for a computer science undergrad, in no particular order.</p>
<h2 id="maths"><strong>Maths</strong></h2>
<h3 id="calculus">Calculus</h3>
<p>Calculus is a fundamental subject that helps understand many computer science concepts, such as optimization, machine learning, and differential equations. It&rsquo;s essential to have a good grasp of limits, derivatives, basic integrals, and multi-variable calculus.</p>
<h3 id="discrete-mathematics">Discrete Mathematics</h3>
<p>Discrete mathematics is crucial for understanding fundamental concepts like graphs, networks, and combinatorics. It&rsquo;s essential for solving problems in computer science, including graph theory, number theory, and combinatorial mathematics.</p>
<h3 id="probability-and-statistics">Probability and Statistics</h3>
<p>Probability and statistics are important for understanding random processes, machine learning, and data analysis. It&rsquo;s essential to have a good understanding of probability theory, statistical inference, and data visualization.</p>
<h3 id="linear-algebra">Linear Algebra</h3>
<p>Linear algebra is useful for understanding matrix operations, eigenvalues, and various machine learning techniques. It&rsquo;s essential for solving problems in computer science, including computer vision, signal processing, and machine learning.</p>
<h2 id="computer-science"><strong>Computer Science</strong></h2>
<h3 id="programming">Programming</h3>
<p>Programming is a self-explanatory topic, but it&rsquo;s essential to have a strong foundation in at least one programming language (e.g., Python, Java, C++). It&rsquo;s crucial for developing problem-solving skills, understanding algorithms, and creating software.</p>
<h3 id="databases">Databases</h3>
<p>Understanding the basics of database systems, including data modeling, querying, and storage, is essential for any computer science student. It&rsquo;s critical for developing scalable and efficient software systems.</p>
<h3 id="data-structures-and-algorithms">Data Structures and Algorithms</h3>
<p>Data structures and algorithms are critical for solving complex problems efficiently and effectively. It&rsquo;s essential to have a good understanding of various data structures, including arrays, linked lists, stacks, and queues.</p>
<h3 id="programming-languages">Programming Languages</h3>
<p>Familiarity with multiple programming languages is valuable, as each has its strengths and weaknesses. It&rsquo;s essential for developing a broad range of skills and adapting to new technologies.</p>
<h3 id="computer-architecture">Computer Architecture</h3>
<p>Understanding how computers operate at a low level, including processors, memory, and storage, is essential for any computer science student. It&rsquo;s critical for developing efficient software systems and optimizing performance.</p>
<h3 id="operating-systems">Operating Systems</h3>
<p>Familiarity with the basics of operating systems, including process management, file systems, and memory management, is essential for any computer science student. It&rsquo;s critical for developing scalable and efficient software systems.</p>
<h3 id="ai">AI</h3>
<p>Artificial intelligence is a broad field, but understanding the basics of machine learning, deep learning, and natural language processing is essential for any computer science student.</p>
<h3 id="computer-networks">Computer Networks</h3>
<p>Understanding how computers communicate and exchange data is crucial in today&rsquo;s interconnected world. It&rsquo;s essential for developing efficient software systems and optimizing performance.</p>
<h3 id="software-engineering">Software Engineering</h3>
<p>Familiarity with software development methodologies, design patterns, and testing strategies is valuable in industry. It&rsquo;s essential for developing maintainable, efficient, and scalable software systems.</p>
<h3 id="human-computer-interaction-hci">Human-Computer Interaction (HCI)</h3>
<p>Understanding how people interact with computers and designing user-friendly interfaces is essential for any computer science student. It&rsquo;s critical for developing intuitive and user-friendly software systems.</p>
<h2 id="conclusion"><strong>Conclusion</strong></h2>
<p>The list above covers a wide range of topics, providing a solid foundation for a computer science undergrad. It&rsquo;s essential to remember that computer science is a vast field, and you&rsquo;ll likely need to specialize or explore specific areas in more depth.</p>
<p>To succeed in the field, it&rsquo;s essential to:</p>
<ul>
<li>Engage with projects, hackathons, or coding competitions to apply theoretical knowledge and gain practical experience.</li>
<li>Stay up-to-date with the latest developments in the field, and be prepared to adapt to new technologies and trends.</li>
<li>Explore additional topics, such as cybersecurity, data science, and web development, to broaden your skills and knowledge.</li>
</ul>
<p>By following this guidance, you&rsquo;ll be well-equipped to tackle the challenges and opportunities in the field of computer science.</p>
]]></content>
        </item>
        
        <item>
            <title>How to Get a Computer Science Degree Fast and Cheaply</title>
            <link>https://victoramartinez.com/posts/how-to-get-a-bscs-efficiently/</link>
            <pubDate>Mon, 16 Dec 2024 00:00:00 +0000</pubDate>
            
            <guid>https://victoramartinez.com/posts/how-to-get-a-bscs-efficiently/</guid>
            <description>&lt;p&gt;You read the title, you&amp;rsquo;re probably thinking &amp;ldquo;that sounds like it&amp;rsquo;ll be a crappy idea&amp;rdquo; or &amp;ldquo;that sounds exactly like what I want!&amp;rdquo; For the first person, I hope to convince you that a computer science degree need not take 4 years nor be expensive. For the second, I hope to give you a roadmap to earn an accredited CS degree. But, before I start I want to preface this by saying that I am not advocating you go out to a degree mill and just buy a Diploma from a fake school, I&amp;rsquo;ll only be talking about legal, accredited, and reputable ways to get your degree in under 2 years, even less. I also know that it&amp;rsquo;s possible, because I essentially did it last year. So, without further ado, here&amp;rsquo;s how to get a bachelors degree in computer science fast and cheaply.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>You read the title, you&rsquo;re probably thinking &ldquo;that sounds like it&rsquo;ll be a crappy idea&rdquo; or &ldquo;that sounds exactly like what I want!&rdquo; For the first person, I hope to convince you that a computer science degree need not take 4 years nor be expensive. For the second, I hope to give you a roadmap to earn an accredited CS degree. But, before I start I want to preface this by saying that I am not advocating you go out to a degree mill and just buy a Diploma from a fake school, I&rsquo;ll only be talking about legal, accredited, and reputable ways to get your degree in under 2 years, even less. I also know that it&rsquo;s possible, because I essentially did it last year. So, without further ado, here&rsquo;s how to get a bachelors degree in computer science fast and cheaply.</p>
<h1 id="step-1-choose-the-right-school">Step 1. Choose the Right School</h1>
<p>This first step will depend on a few things, mainly how much you like the model of education the school uses, how much many credits you can transfer, and if you want more or less free electives. Here&rsquo;s a non-comprehensive list of schools I recommend, and yes they&rsquo;re all Online</p>
<h2 id="western-governors-university">Western Governors University</h2>
<p>This is the school I ended up going to. I absolutely love their model for education and they are the only online school to have ABET accreditation for their BSCS degree on top of Institutional Accreditation from the NWCCU. They also have a BSSWE that&rsquo;s prety good if you want to take a more hands on approach and wish to specialize in software engineering from the beginning.</p>
<p>WGU will run you about ~$4700 per six month term and terms start the first of every month. They use a subscription-based competency-based model of education, which means you pay for the term, not per class and you can take as many classes as you can pass each term. Competency-based means that you essentially test out of classes by passing one big final exam or doing a few projects, write a few papers and getting a good grade. At WGU, to pass a class you simply need to show competency by either passing a test with a score of 80% or higher or complete a project and have an evaluator sign off on it. This model lets you move as fast or as slow as you wish, provided you complete at least 12 CUs per term when. I was able to finish 61 CUs or 19 courses in 4 months because I was able to apply what I already knew to pass and concentrate on what I didn&rsquo;t know, like discrete mathematics.</p>
<h3 id="pros">Pros:</h3>
<ul>
<li>Cheap</li>
<li>ABET accreditation</li>
<li>Fast</li>
<li>Competency-based</li>
<li>Well known for around tech circles</li>
<li>Very transfer friendly</li>
<li>Instructors are knowledgeable and experts in their field, usually with doctorates</li>
<li>You get assigned a professional mentor throughout your degree</li>
</ul>
<h3 id="cons">Cons:</h3>
<ul>
<li>There are no lectures, it&rsquo;s all self-paced modules with live cohorts from instructors occasionally</li>
<li>Does not accept international students</li>
<li>No free electives, it&rsquo;s all structured so there&rsquo;s no place to put any extra credits you might&rsquo;ve taken in other schools</li>
</ul>
<h2 id="southern-new-hampshire-university">Southern New Hampshire University</h2>
<p>The so-called Walmart of higher education, because they have almost every degree, but hey they&rsquo;re cheap and they&rsquo;re accredited. I like SNHU because of these reasons:</p>
<ul>
<li>Lots of specializations for their BSCS, including:
<ul>
<li>Data Analysis</li>
<li>Information Security</li>
<li>Project Management for STEM</li>
<li>Software Engineering</li>
</ul>
</li>
<li>Very transfer friendly, accepting ACE, CLEP and other alternative credits for up to 90 credits of a 120 credit degree, letting you finish in less than 18 months potentially and only costing you $9,900.</li>
<li>Short 8 week terms means you can move pretty quickly</li>
<li>Accepting of international students</li>
</ul>
<p>What I don&rsquo;t like:</p>
<ul>
<li>They made certain courses <a href="https://youtu.be/kSIivikonM0">less hackable recently</a>.</li>
<li>You pay per-credit not per-term like at WGU so you can&rsquo;t save more by taking more classes per term.</li>
</ul>
<p>Overall, though. It&rsquo;s a great school and it&rsquo;s a good option if you want to get into one of their specializations and you can&rsquo;t find it anywhere else or you can&rsquo;t get into WGU.</p>
<h2 id="thomas-edison-state-university">Thomas Edison State University</h2>
<p>This is a very little known state school from New Jersey. They&rsquo;re one of the few public schools on this list as they are part of the New Jersey university system. I really like this school because they are designed explicitly for adult learners, they&rsquo;re cheap, accredited, non-profit, and their degrees are very flexible.</p>
<p>They have a Bachelors of Arts in Computer Science and a Bachelor of Science in Computer Information Systems that are very hackable and transfer friendly with a lot of free electives letting you choose what you want to study. They&rsquo;re very close in cost to WGU costing around $4400 per term, but they&rsquo;re not competency-based. The great thing tho, is that you can still test out of a lot of classes.</p>
<h2 id="colorado-state-university-global">Colorado State University Global</h2>
<p>I like this school mostly because a friend of mine completed their BSCS there, but wanted to go to WGU and couldn&rsquo;t becaus they were an international student. It&rsquo;s relatively cheap, costing $9,000 and with more savings if your transfer up to 90 credits. They&rsquo;re run by Colorado State University and art a public university, fully accredited just like CSU.</p>
<h2 id="honorable-mention">Honorable Mention</h2>
<h3 id="liberty-university">Liberty University</h3>
<p>Though Liberty does not offer their computer science degree proper online, they do offer a very close Computational Mathematics (B.S) with a concentration in Computer Science online. They&rsquo;re very cheap, at $390 per credit, with the option to transfer in up to 75% of the degree, leaving you with only $11,700 left to pay and you can finish in under 2 years.</p>
<h1 id="step-2-transfer-in-alternative-credits">Step 2. Transfer in Alternative Credits</h1>
<p>Now that you&rsquo;ve chosen an accredited school that&rsquo;s transfer friendly and online, you&rsquo;ll want to transfer in as many credits as possible to finish even sooner and save even more money. My first recommendation is to lookup the school&rsquo;s transfer policy, either on their website or the website of the alternative credit site, and see how many alternative credits you can transfer from places like CLEP, Study.com, Sophia.org, and StraighterLine.</p>
<h2 id="clep"><a href="https://clep.collegeboard.org/">CLEP</a></h2>
<p><a href="https://clep.collegeboard.org/">CLEP</a> or the College-Level Examination Program is a program designed by the College Board to evaluate students and recommend them for college credit should they pass the tests over a certain level. Depending on the score you get in certain exams you can get anywhere from 3, 6, even 9 credits! (depending on the school). CLEP is also in-expensive, coming at $95 per test, which is way cheaper than paying for college courses. In some cases, you can get CLEP for free depending on your high school or if you use <a href="https://modernstates.org/">Modern States</a></p>
<p>They have tests ranging from American Government to Calculus, so these tests will mostly cover any general education or elective credits you might need to pass.</p>
<p>Checkout which schools accept CLEP <a href="https://clep.collegeboard.org/clep-college-credit-policy-search">here</a>.</p>
<h2 id="sophiaorg"><a href="https://sophia.org/">Sophia.org</a></h2>
<p>This is one of my favorites, as it&rsquo;s one of the subscription based options that is really easy to pass quickly. I did 18 Sophia.org credits in 3 months at a leisurely pace. They have courses that cover more than just general education, but also some required courses for many schools, including Intro to Java Programming, Intro to Python Programming, Intro to Relational Databases, Intro to Networking, etc. They also have one of the easiest Calculus courses online as it&rsquo;s open book exams. It&rsquo;s just $99 a month or $299 or $599 for 4 and 12 months respectively and you&rsquo;re paying per subscription not per course.</p>
<p>Checkout their transfer partners <a href="https://www.sophia.org/find-your-school/">here</a></p>
<h2 id="studycom">Study.com</h2>
<p><a href="https://study.com">Study.com</a> is probably the biggest and oldest of the online ACE credit websites. They have courses that cover nearly everything, letting you earn basically most of your degree here for a low flat rate. It costs around $199 per month and you get 2 free proctored exams per month, additional exams are $70 and you can take up to 5 exams per month, for a theoretical cost of $210 per month if you move at an accelerated pace. They have courses ranging from Calculus to Computer Architecture. Check out which schools they transfer to <a href="https://study.com/college/school/index.html#transferSearch">here</a>.</p>
<h2 id="recommendations">Recommendations</h2>
<p>Take Calculus at Sophia.org, it&rsquo;s by far the easiest and it&rsquo;s accepted at every school listed here. Use CLEP for things you already know and test out of quickly. Sophia.org is great for getting courses out quickly, so take as many of those which will transfer as possible and do the rest at Study.com.</p>
<p>Make sure to view your schools transfer policy for each program. Here&rsquo;s the ones for WGU for example:</p>
<h3 id="wgu">WGU</h3>
<p><a href="https://partners.wgu.edu/transfer-pathway-agreement?uniqueId=BSCS7110&amp;collegeCode=IT&amp;instId=796&amp;programId=182">WGU Transfer Pathways Agreement for Sophia Learning LLC</a></p>
<p><a href="https://partners.wgu.edu/transfer-pathway-agreement?uniqueId=BSCS4424&amp;collegeCode=IT&amp;instId=678&amp;programId=182">WGU Transfer Pathways Agreement for Study.com</a></p>
<h3 id="snhu">SNHU</h3>
<p><a href="https://snhu.sophia.org/">Sophia.org</a></p>
<p><a href="https://study.com/college/school/snhu.html">Study.com</a></p>
<h3 id="tesu">TESU</h3>
<p><a href="https://study.com/college/school/thomas-edison-state-university.html">Study.com</a></p>
<p><a href="https://tesu.sophia.org/">Sophia.org</a></p>
<h3 id="csu-global">CSU Global</h3>
<p><a href="https://study.com/college/school/csu-global.html">Study.com</a></p>
<p><a href="https://csuglobal.sophia.org/">Sophia.org</a></p>
<h1 id="step-3-get-a-transfer-evaluation-and-enroll">Step 3. Get a transfer evaluation and enroll</h1>
<p>After you&rsquo;ve taken all the courses you needed or wanted to at sites like Sophia or Study.com it&rsquo;s time to finally apply and get a transfer evaluation from your target school and finally enroll. With WGU you can apply and get a transfer evaluation while you get your alternative credits. But whatever you do, make sure you have ALL your alternative credits transferred in and evaluated BEFORE you enroll. In most cases you cannot transfer in more credits once you enrolled.</p>
<p>If you did everything right, you should be sitting pretty and have only 50 to 25 per-cent of your degree left and you can finish in about a year. If you&rsquo;re like me, you <a href="/posts/on-finishing-my-bscs/">finish in 4 months</a></p>
<h1 id="step-4-graduate">Step 4. Graduate</h1>
<p>That&rsquo;s it, if you did everything right, all you have to do is finish!</p>
<h1 id="conclusion">Conclusion</h1>
<p>Hopefully after reading this, you can see how you can finish an accredited computer science degree in 6 months to 2 years for less than $15k! If you take my route you can finish in under a year and for less than $5k. So go get it! The quicker you can finish a CS degree the quicker you can get into the industry and start making money or go into a masters program. I went this route and now <a href="/posts/accepted-to-gt/">I&rsquo;m a graduate student at Georgia Tech.</a>. Good luck to you and go get that education! がんばってください！</p>
]]></content>
        </item>
        
        <item>
            <title>Accepted to Georgia Tech</title>
            <link>https://victoramartinez.com/posts/accepted-to-gt/</link>
            <pubDate>Fri, 29 Nov 2024 22:16:40 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/accepted-to-gt/</guid>
            <description>&lt;p&gt;Back on May 31st, 2024, right as I submitted my last assignment for my capstone course, my last class on my BSCS at WGU, I applied for Georgia Tech’s OMSCS program. In August, days before my graduation ceremony, I heard back that I got accepted into the Spring 2025 cohort of Georgia Tech’s Online Masters of Science in Computer Science and this week I just got my gatech.edu email address.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>Back on May 31st, 2024, right as I submitted my last assignment for my capstone course, my last class on my BSCS at WGU, I applied for Georgia Tech’s OMSCS program. In August, days before my graduation ceremony, I heard back that I got accepted into the Spring 2025 cohort of Georgia Tech’s Online Masters of Science in Computer Science and this week I just got my gatech.edu email address.</p>
<p>I’m excited to be taking part in this amazing program, it’s really a dream come true. This will give me an opportunity to really focus in on areas of computer science I find most interesting. I plan on doing the Interactive Intelligence specialization. Now I know what you’re probably thinking (or not, I don’t personally know you and it’s rude to assume, but I can make a pretty good guess) “oh boy, just another one looking to get in on the AI hyper train.” Well, no… You see, for me AI and ML have always been an are of intrigue for me since my first freshman year back in 2013, during my first degree attempt and I want to learn about AI as a field in general because of a personal curiosity of not just AI itself, but computer science as a whole.</p>
<h2 id="why-georgia-tech">Why Georgia Tech?</h2>
<p>For me, besides Georgia Tech being one of my dream schools when I first wanted to go to college, there are several other factors for why I choose GT. These include a high ranking among computer science departments, program affordability, name recognition, and rigorous academic standards.</p>
<p>As of the time of this blog post, Georgia Tech ranks #7 in computer science and #5 in artificial intelligence among US colleges in the US News and World Report rankings, ranks #3 on <a href="https://csrankings.org">csrankings.org</a>, and #9 on niche.org. Suffice it to say it’s easily a top 5 to 10 school for computer science.</p>
<p>The program is easily affordable to me, costing less than $10k for the whole package. Not adjusting for any future inflation, it’ll cost around $7000 in 2.5 or 3 years for all 10 courses plus fees or around $700 per course. For a top 5 school masters program, this is a steal of a deal.</p>
<p>Of course, I don’t have to convince you that having gone to Georgia Tech is a big resume boost. I didn’t specifically choose them for that reason, but I cannot lie and say it didn’t factor in. Don’t get me wrong, <a href="https://wgu.edu">WGU</a> was a good school and I am forever grateful for them giving the opportunity to finish with a reputable degree, but having them on your resume is not a huge boost other than ticking the accredited degree box. Having gone and finished Georgia Tech would give me huge edge in the job market on top of my experience.</p>
<p>Finally Georgia Tech is well known for its high academic standards and rigorous academic programs. I do not expect this graduate program to be easy nor do I want it to be. I want a challenge not only for its sake, but to push me towards learning new things.</p>
<h2 id="excited-for-the-future">Excited For the Future</h2>
<p>I’m extremely excited for the future. I’ll be working hard towards my studies and my career. And that’s really all I could ever hope to do.</p>
<p>I’ll let you all know in a few years if I managed to complete the program and throughout the program I’ll keep you updated on what I’m doing and how I’m doing it.</p>
<p>See you on the other side!</p>
]]></content>
        </item>
        
        <item>
            <title>On Finishing My BSCS</title>
            <link>https://victoramartinez.com/posts/on-finishing-my-bscs/</link>
            <pubDate>Mon, 24 Jun 2024 03:42:30 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/on-finishing-my-bscs/</guid>
            <description>&lt;p&gt;Over the past four plus months, upon writing this on June 24, 2024 at 3:05 am AST, I had been working on my finishing my Bachelor of Science, Computer Science from Western Governors University. I am proud to say that I am now a proud graduate of WGU and will be attending commencement in September; I already bought the airline tickets plus the cap and gown. In this post I will outline my experience going through the curriculum at WGU, how many credits I transferred from where, and total up how long it took me to finish my degree and outline my plans for the future.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>Over the past four plus months, upon writing this on June 24, 2024 at 3:05 am AST, I had been working on my finishing my Bachelor of Science, Computer Science from Western Governors University. I am proud to say that I am now a proud graduate of WGU and will be attending commencement in September; I already bought the airline tickets plus the cap and gown. In this post I will outline my experience going through the curriculum at WGU, how many credits I transferred from where, and total up how long it took me to finish my degree and outline my plans for the future.</p>
<p>But first, let me outline why I did this. I&rsquo;ve been working for close to 9 years as a software engineer, including 2 years of internships and 7+ years of non-internship work experience. I had been thrusted onto the roll of senior software engineer in my last job over the course of two years and had lead a team of 6 other developers. I felt like I was at the top of my game, but something was missing, but what? I was noticing that I was starting to lack in certain areas of theoretical knowledge and lacked the structure and accountability to master them. I had attempted a degree before, once in 2013 through 2017 as a computer engineering student at the University of Puerto Rico, and then transferred over to Computer Science at the Polytechnic University of Puerto Rico when I found hardware too uninteresting and difficult. During the transfer, nearly nothing had transferred over so I had to start all over again, I was the equivalent of a Junior or Sophomore, it was rough. Over the course of three years, I was passing classes left and right, keeping an above 3.0 GPA while also holding down a full-time 9 to 5 job.</p>
<p>Then in 2020, the pandemic went into its apogee. It had reached PR and all classes were moved online and it was rough. It was after a few horrible experiences with professors and students who didn&rsquo;t know how to work the online format that I decided to instead focus on my career, as I also didn&rsquo;t have time to finish my degree, or so I thought. Fast forward to 2023 and I found out about WGU. At first I was skeptical, I had always been about online universities, but the more I dug the more I was interested and even impressed. I found out the school was fully accredited, not only regionally, but by ABET. So I decided to take the plunge and in September of 2023 I pre-enrolled and picked a Fall 2024 start date and over the course of three months I rushed to finish as many of the general ed courses as I could at Sophia.org. Come February 1st, 2024, I had been pre-studying for a month for my first official WGU course, Discrete Mathematics II. The great thing about WGU is that classes are competency-based, which means that you simply have to prove that you know the material through either a test, a project, or a combination of both. DMII was a proctored test taking 140 minutes. I didn&rsquo;t want to waste time, so I looked up all the material for the test before I was officially enrolled, and started studying and practicing every single day after work. I am proud to say that I passed that course with flying colors. That bit of success and the quickness with which I was able to get it over with was exactly what I needed to keep me going.</p>
<p>Over the course of the next four and a half months, I was moving at a pace of around 4 courses a month. I worked with my mentor to make sure I did all my Objective Assessments (exams) courses first. I didn&rsquo;t want to waste time near the end of my six month term studying so that I could focus on all the projects I needed to do and finally my capstone project. And let me tell you, it was intense. My days basically consisted of working and studying during my free time and taking exams at odd hours of the night. Later when I got to just my Performance Assessment courses, my time consisted of working on my projects during my off hours. It was honestly, pretty amazing. I was doing projects that helped me learned relevant skills and put my knowledge into practice. In my Data Structures and Algorithms II course, I had to write a delivery truck program that found the best path for delivering packages using three trucks, but only two of which could be active at the same time. I was forced to use python, invent my own loading algorithms and keep everything original. And in my capstone project I needed to develop a machine learning model and use it in an application with a topic of my choosing, which obviously gave me a nice introduction of machine learning methods.</p>
<p>In a little over 4 months time, I finished 61 Competency Units (basically credit hours) and obtained my degree on June 11th, 2024. I had transferred over 62 CUs from between my previous schools, UPR (8 CUs), PUPR (34 CUs), and Sophia.org (20CUs). I finished 19 classes in 4.5 months and earned a Axelos ITIL Foundation Certificate.</p>
<p>Why did I do this? Simple. I wanted my degree and I wanted to be able to apply for a masters program. At the time of writing this I have applied for three schools, Georgia Tech&rsquo;s OMSCS, UT Austin&rsquo;s MSCSO, and ASU&rsquo;s MCS Online. I want to get a masters because an unfortunate reality is that now a days most everyone in software has bachelors and between 50% to 90% of applicants have masters degrees, so I need to catch up. My top choices are Georgia Tech and UT Austin, though ASU&rsquo;s curriculum may turn out to be faster, with two 7.5 week sessions per Spring and Fall semester, allowing for me to take 2 classes a semester plus a summer, finishing in 1.5 years if taking only one class per session. That might well be worth the $15k the degree costs, we&rsquo;ll see.</p>
<p>In any case, that&rsquo;s what got me up to this point. I&rsquo;ll be going to my commencement in Orlando this September and I&rsquo;m sure that by that time I should know which of the three schools have accepted me and which one I&rsquo;m going to attend. I&rsquo;ll be posting and update for that then. For now, I&rsquo;m just going to take it easy and learn about some machine learning on the side, maybe read a few books on it or do some online courses and perhaps refresh my linear algebra, but for now I&rsquo;lll just be getting back to my life being school free, just for a little while until Spring 2025. Then the real fun begins.</p>
]]></content>
        </item>
        
        <item>
            <title>Defensive Commits</title>
            <link>https://victoramartinez.com/posts/defensive-commits/</link>
            <pubDate>Sat, 22 Oct 2022 21:55:26 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/defensive-commits/</guid>
            <description>&lt;p&gt;Defensive Commits are a strategy for pushing commit to upstream repos that runs part of the ci/cd pipeline locally using git hooks. It fails the hook fails. This allows you to catch integration errors and get feedback quickly. This strategy works best with &lt;a href=&#34;https://trunkbaseddevelopment.com&#34;&gt;trunk-based development&lt;/a&gt; and ci/cd teams, because it helps avoid breaking the build and reduces dumb mistakes from even being pushed up to main.&lt;/p&gt;
&lt;p&gt;At &lt;a href=&#34;https://coquihealth.com&#34;&gt;Coqui Health&lt;/a&gt;, we&amp;rsquo;ve implemented this strategy successfully and this is now the default way we work. We use a monorepo strategy coupled with ci/cd and trunk-based development, which means we work close to or in trunk and so having a robust ci/cd pipeline is paramount. Defensive commits allows us to catch bugs early and get feedback that our code will work or break things. It&amp;rsquo;s allowed us to move faster and not break things.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>Defensive Commits are a strategy for pushing commit to upstream repos that runs part of the ci/cd pipeline locally using git hooks. It fails the hook fails. This allows you to catch integration errors and get feedback quickly. This strategy works best with <a href="https://trunkbaseddevelopment.com">trunk-based development</a> and ci/cd teams, because it helps avoid breaking the build and reduces dumb mistakes from even being pushed up to main.</p>
<p>At <a href="https://coquihealth.com">Coqui Health</a>, we&rsquo;ve implemented this strategy successfully and this is now the default way we work. We use a monorepo strategy coupled with ci/cd and trunk-based development, which means we work close to or in trunk and so having a robust ci/cd pipeline is paramount. Defensive commits allows us to catch bugs early and get feedback that our code will work or break things. It&rsquo;s allowed us to move faster and not break things.</p>
<h2 id="how-to-implement">How to Implement</h2>
<p>The easiest way to implement Defensive Commits (TM) is to use git hooks, particularly on push or after a commit, literally. We used <a href="https://typicode.github.io/husky/#/">husky</a> to help us do this.</p>
<p>First install and configure husky</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npx husky-init <span style="color:#f92672">&amp;&amp;</span> npm install       <span style="color:#75715e"># npm</span>
</span></span></code></pre></div><p>Then configure the git hooks, like this for pre-push</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npx husky add .husky/pre-push <span style="color:#e6db74">&#34;npm test&#34;</span>
</span></span></code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>Using this strategy you can save a lot of time and effort from having to wait for ci/cd pipelines and potentially braking the build over stupid little things. I can&rsquo;t guarantee your build will never break, but the probability it will fail is a lot less.</p>
]]></content>
        </item>
        
        <item>
            <title>Getting Back to Blogging</title>
            <link>https://victoramartinez.com/posts/getting-back-to-blogging/</link>
            <pubDate>Sun, 19 Dec 2021 17:22:45 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/getting-back-to-blogging/</guid>
            <description>&lt;p&gt;It&amp;rsquo;s been a long time since I last made a post. More than a year, actually. Since then, I&amp;rsquo;ve been really busy finding new work, finishing school, and getting my life in order. I want to get back into blogging and I&amp;rsquo;ve been so full of ideas.&lt;/p&gt;
&lt;p&gt;Recently I&amp;rsquo;ve been thinking a lot about finance, economics, and of course programming. I want to share my findings with you in hopes that this will help someone. So with that declaration out of the way, let&amp;rsquo;s get back to it!&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>It&rsquo;s been a long time since I last made a post. More than a year, actually. Since then, I&rsquo;ve been really busy finding new work, finishing school, and getting my life in order. I want to get back into blogging and I&rsquo;ve been so full of ideas.</p>
<p>Recently I&rsquo;ve been thinking a lot about finance, economics, and of course programming. I want to share my findings with you in hopes that this will help someone. So with that declaration out of the way, let&rsquo;s get back to it!</p>
]]></content>
        </item>
        
        <item>
            <title>Value Objects in Go</title>
            <link>https://victoramartinez.com/posts/value-objects-in-go-and-other-domain-driven-design-stuff/</link>
            <pubDate>Fri, 23 Oct 2020 03:12:35 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/value-objects-in-go-and-other-domain-driven-design-stuff/</guid>
            <description>&lt;p&gt;Recently I&amp;rsquo;ve been thinking a lot about how to apply some DDD principles in Go in idiomatic and simple ways, and I&amp;rsquo;ve come accross a few patterns I&amp;rsquo;d like to share. Mainly we&amp;rsquo;ll be talking about how to apply the concept of Value Objects in Go in two ways. These are examples of how I apply them in my projects and actually use them so these are not just toy examples.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>Recently I&rsquo;ve been thinking a lot about how to apply some DDD principles in Go in idiomatic and simple ways, and I&rsquo;ve come accross a few patterns I&rsquo;d like to share. Mainly we&rsquo;ll be talking about how to apply the concept of Value Objects in Go in two ways. These are examples of how I apply them in my projects and actually use them so these are not just toy examples.</p>
<h2 id="description">Description</h2>
<p>What is a value object first of all? It&rsquo;s an object that isn&rsquo;t quite an entity, but represents data that entities might use to complete their tasks. These are, as the name sugests, objects that contain the values of something useful to the domain being worked on. Examples of these objects include Social Security Numbers, Names of people, Locations, Dates, Routing information, etc. Two of the key characteristics for value is that they are 1. Immutable and 2. not littering our domain with just strings.</p>
<h2 id="always-valid">Always Valid</h2>
<p>On top of what the concept of a value object, I&rsquo;d like to introduce the concept of an always valid value object. For value objects that represent something more complex or have strict validation rules, I often introduce the concept of them always being valid once created. That is to say if when constructing the object all the inputs are valid then the object is always in a valid state, otherwise it is never created. Put another way, you cannot create and use a value object that isn&rsquo;t valid.</p>
<h3 id="immutability">Immutability</h3>
<p>In order to be always valid, the object must be immutable. To do that in Go we use encapsulation by using package level hiding of fields.</p>
<h2 id="implementing-in-go">Implementing in Go</h2>
<p>The first and and most common kind of value object I create in Go is the simple type alias.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ID</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">City</span> <span style="color:#66d9ef">string</span>
</span></span></code></pre></div><p>If the object does not need complex validation and is just a simple field then it can be a type alias. Examples include things like ids, names that don&rsquo;t need to be checked if empty or not, and sometimes certain numbers. Some value objects are even simpler and come with the standard library, such as <code>time.Time</code> (tho admitidly internally internally it is more complex) and <code>bool</code>.</p>
<p>The second kind is one that I also use often, if not more often considering that it represents complex concepts, is the immutable field value object.</p>
<p>As an example, take a name field that need to be within a certain length of characters. We&rsquo;d implement them in Go like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Name</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// explicitly not public field</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// NewName creates a new valid name object</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewName</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">Name</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">name</span>) &gt; <span style="color:#ae81ff">20</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Name</span>{}, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;invalid name, must be withn 20 charcters and non-empty&#34;</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Name</span>{<span style="color:#a6e22e">name</span>: <span style="color:#a6e22e">name</span>}, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// String implements the fmt.Stringer interface.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">Name</span>) <span style="color:#a6e22e">String</span>() <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">name</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// MarshalText used to serialize the object</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">Name</span>) <span style="color:#a6e22e">MarshalText</span>() ([]<span style="color:#66d9ef">byte</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> []byte(<span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">name</span>), <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// UnmarshalText deserializes the object and returns an error if it&#39;s invalid. </span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">n</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Name</span>) <span style="color:#a6e22e">UnmarshalText</span>(<span style="color:#a6e22e">d</span> []<span style="color:#66d9ef">byte</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">*</span><span style="color:#a6e22e">n</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">NewName</span>(string(<span style="color:#a6e22e">d</span>))
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>A few things to note are that first, the only way to create the object is through the constructor; there&rsquo;s no other way, this way we gaurantee it&rsquo;s valid once created. If it&rsquo;s invalid to create it, we quickly return an error. The other thing to note is the implementation of the Stringer, TextMarshaller, and TextUnmarshaller interfaces; we do this so that it is easy to serialize and deserialize the objects.</p>
<p>With all those combined, we&rsquo;ve created our value objects and this has several advantages. Firstly when we use these objects we can rest assured that they are always valid. When created, say in our application layer we can quickly validate them. The aggregates need not worry about checking them nor should the application code, because they are never in an invalid state nor in any risk of being set to something invalid. The only check we should enforce in our aggregates and service layers is to check if one of the simpler types are empty when using them if that&rsquo;s something we need to have not happen, other than that it&rsquo;s simple to just assume they aren&rsquo;t empty.</p>
<p>We can of course create value object out of value objects, but that&rsquo;s another story.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In Go, value object are simple to implement and we can reap numerous rewards by applying the always valid concept. With that, I&rsquo;ll let you Go and may your objects always be valid.</p>
]]></content>
        </item>
        
        <item>
            <title>Stop The EARN IT Act</title>
            <link>https://victoramartinez.com/posts/stop-earn-it-act/</link>
            <pubDate>Wed, 25 Mar 2020 19:51:27 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/stop-earn-it-act/</guid>
            <description>&lt;p&gt;A new threat to your freedom of speech and privacy has appeared. Senators Lindsey Graham (R-SC) and Richard Blumenthal (D-CT) have joined in introducing the &lt;a href=&#34;https://www.congress.gov/bill/116th-congress/senate-bill/3398&#34;&gt;EARN IT Act (S. 3398)&lt;/a&gt; bill in Congress. This act&amp;rsquo;s intention is hidden behind the guise of protecting children, but in reality seeks to potentially undermine the end-to-end encryption and security that exists for almost all internet communications, especially social messaging platforms like WhatsApp and other U.S. based messaging platforms. This would give dangerous men like Attorney General William Barr, who has expressed his opinions about encryption in the past, the legal authority to demand platforms decrypt communications. Don&amp;rsquo;t be fooled, if this bill passes it will do little to actually protect children and instead put your data and private conversations at risk to online criminals and foreign governments. It is not just your private messages, but other means of communications that are at risk.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>A new threat to your freedom of speech and privacy has appeared. Senators Lindsey Graham (R-SC) and Richard Blumenthal (D-CT) have joined in introducing the <a href="https://www.congress.gov/bill/116th-congress/senate-bill/3398">EARN IT Act (S. 3398)</a> bill in Congress. This act&rsquo;s intention is hidden behind the guise of protecting children, but in reality seeks to potentially undermine the end-to-end encryption and security that exists for almost all internet communications, especially social messaging platforms like WhatsApp and other U.S. based messaging platforms. This would give dangerous men like Attorney General William Barr, who has expressed his opinions about encryption in the past, the legal authority to demand platforms decrypt communications. Don&rsquo;t be fooled, if this bill passes it will do little to actually protect children and instead put your data and private conversations at risk to online criminals and foreign governments. It is not just your private messages, but other means of communications that are at risk.</p>
<p>Various rights watch organizations have already denounced the bill, including the <a href="https://www.aclu.org/press-releases/aclu-afp-comment-earn-it-act">ACLU</a>.</p>
<blockquote>
<p>Tech companies have an extraordinary special safeguard against legal liability, but that unique protection comes with a responsibility. Companies that fail to comport with basic standards that protect children from exploitation have betrayed the public trust granted them by this special exemption. Online platforms&rsquo; near-complete immunity from legal responsibility is a privilege – they have to earn it – and that&rsquo;s what our bipartisan bill requires.</p>
<p>&ndash; <!-- raw HTML omitted -->Blumenthal<!-- raw HTML omitted --></p></blockquote>
<p>Don&rsquo;t be fooled. Companies do not have to &ldquo;earn&rdquo; this immunity from what their users say and do on their platforms. What&rsquo;s more, it&rsquo;s a false premise. Online criminals will use other means to conduct their operations and believe me, they will. This only hurts the everyday citizen, who has done nothing wrong and has everything to lose.</p>
<blockquote>
<p>I’ve got to say that putting our children at risk for what I believe are marginal privacy gains is something I really struggle to believe any of us want.</p>
<p>&ndash; <!-- raw HTML omitted -->James Brokenshire<!-- raw HTML omitted --></p></blockquote>
<p>Many security and privacy experts, as expected, disagree with that assessment. And, In my opinion, is a red flag to what the <a href="https://wired.com/story/earn-it-act-sneak-attack-on-encryption/">true intentions</a> of these politicians are. Either that or they are so completely ignorant of how all of this works that it is borderline irresponsible. We are not dealing with tech-savvy or even privacy-savvy individuals.</p>
<p>What&rsquo;s more, there are serious concerns that this act is <a href="https://cyberlaw.stanford.edu/blog/2020/03/earn-it-act-unconstitutional-fourth-amendment">unconstitutional</a> or at least it should be. Some say that it violates the first and fourth amendments of freedom of speech and the press, and the right to protect against unreasonable searches and seizures. How? By giving courts unprecedented access to previously encrypted information such as emails, private messages, and other documents.</p>
<p>The EARN It Act is a terrible idea. Not just because it won&rsquo;t do what it sets out to do, but because it undermines some of our basic freedoms and puts us all at risk for tyrannical government and cybercrime.</p>
<p>Help stop the EARN IT Act by <a href="https://act.eff.org/action/protect-our-speech-and-security-online-reject-the-graham-blumenthal-bill">contacting</a> your congressperson. Take action <a href="https://act.eff.org/action/protect-our-speech-and-security-online-reject-the-graham-blumenthal-bill">here</a>.</p>
]]></content>
        </item>
        
        <item>
            <title>Don&#39;t Use Frameworks</title>
            <link>https://victoramartinez.com/posts/dont-use-frameworks/</link>
            <pubDate>Tue, 24 Mar 2020 04:32:51 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/dont-use-frameworks/</guid>
            <description>&lt;p&gt;Stop using frameworks for everything. Just stop. You don&amp;rsquo;t need a framework to write good code and deliver products. Don&amp;rsquo;t get me wrong, frameworks are useful, but they are all-consuming and hide the application. So if you shouldn&amp;rsquo;t depend on frameworks what should you do instead? Clean architecture. More specifically, there are some patterns you can follow to better architect your application and think about the structure of your application and remove the need for frameworks to express your application. The patterns I suggest you use are &lt;a href=&#34;https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html&#34;&gt;Clean Architecture&lt;/a&gt;, &lt;a href=&#34;https://www.infoq.com/minibooks/domain-driven-design-quickly/&#34;&gt;Domain Driven Design&lt;/a&gt;, and the &lt;a href=&#34;https://www.youtube.com/watch?v=t86v3N4OshQ&#34;&gt;SOLID&lt;/a&gt; principles. Having a maintainable application is a matter of applying certain design principles and professionalism. In particular, applying &lt;a href=&#34;https://blog.cleancoder.com/uncle-bob/2014/12/17/TheCyclesOfTDD.html&#34;&gt;TDD&lt;/a&gt; or BDD and Domain Driven Design principles. Think about your application before you write a single line of code, design it, and test before you implement it.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>Stop using frameworks for everything. Just stop. You don&rsquo;t need a framework to write good code and deliver products. Don&rsquo;t get me wrong, frameworks are useful, but they are all-consuming and hide the application. So if you shouldn&rsquo;t depend on frameworks what should you do instead? Clean architecture. More specifically, there are some patterns you can follow to better architect your application and think about the structure of your application and remove the need for frameworks to express your application. The patterns I suggest you use are <a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html">Clean Architecture</a>, <a href="https://www.infoq.com/minibooks/domain-driven-design-quickly/">Domain Driven Design</a>, and the <a href="https://www.youtube.com/watch?v=t86v3N4OshQ">SOLID</a> principles. Having a maintainable application is a matter of applying certain design principles and professionalism. In particular, applying <a href="https://blog.cleancoder.com/uncle-bob/2014/12/17/TheCyclesOfTDD.html">TDD</a> or BDD and Domain Driven Design principles. Think about your application before you write a single line of code, design it, and test before you implement it.</p>
<p>What should you do about frameworks then? You can still use them, but only as plugins to your application. The use of a framework should be done by implementing internal interfaces for your applications&rsquo; inner layers. Let me ask you this, how many times have you answered the question &ldquo;what is your architecture?&rdquo; with a phrase like &ldquo;We have a ruby on rails back-end persisted by postgres using an angular front-end?&rdquo; If you have, what you have just described is not an architecture, it is an application stack. And what is the application stack? The stack is a detail! No one cares what your application stack is, well no one who wants to get the work done cares what it is, and you shouldn&rsquo;t either. To be fair, I&rsquo;m not saying your technology stack isn&rsquo;t important at some level, I&rsquo;m saying that it&rsquo;s a detail. So what is an application&rsquo;s architecture then? It is the system of patterns that we use to carry out our application&rsquo;s functionality. Your architecture could be a simple CRUD system, or it might be a complex trading application that receives trade orders as incoming messages and delivers them by reserving credits and emitting order events depending on what state you&rsquo;re in. One thing is clear, your application&rsquo;s architecture is driven by the domain you&rsquo;re in and the complexity of the problem you are solving, a framework is not architecture.</p>
<p>So what does a frameworkless application look like? Here&rsquo;s an example in Go. Let us start by the business rules and implement entities. In this example we&rsquo;re using a Cargo shipping application. Notice that our entities are free of any database dependencies and external concerns.</p>
<h3 id="entities">Entities</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// TrackingID uniquely identifies a particular cargo.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">TrackingID</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Cargo is the central class in the domain model.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Cargo</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TrackingID</span>         <span style="color:#a6e22e">TrackingID</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Origin</span>             <span style="color:#a6e22e">UNLocode</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">RouteSpecification</span> <span style="color:#a6e22e">RouteSpecification</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Itinerary</span>          <span style="color:#a6e22e">Itinerary</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Delivery</span>           <span style="color:#a6e22e">Delivery</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// SpecifyNewRoute specifies a new route for this cargo.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Cargo</span>) <span style="color:#a6e22e">SpecifyNewRoute</span>(<span style="color:#a6e22e">rs</span> <span style="color:#a6e22e">RouteSpecification</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">RouteSpecification</span> = <span style="color:#a6e22e">rs</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Delivery</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Delivery</span>.<span style="color:#a6e22e">UpdateOnRouting</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">RouteSpecification</span>, <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Itinerary</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// AssignToRoute attaches a new itinerary to this cargo.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Cargo</span>) <span style="color:#a6e22e">AssignToRoute</span>(<span style="color:#a6e22e">itinerary</span> <span style="color:#a6e22e">Itinerary</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Itinerary</span> = <span style="color:#a6e22e">itinerary</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Delivery</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Delivery</span>.<span style="color:#a6e22e">UpdateOnRouting</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">RouteSpecification</span>, <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Itinerary</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// DeriveDeliveryProgress updates all aspects of the cargo aggregate status</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// based on the current route specification, itinerary and handling of the cargo.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Cargo</span>) <span style="color:#a6e22e">DeriveDeliveryProgress</span>(<span style="color:#a6e22e">history</span> <span style="color:#a6e22e">HandlingHistory</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Delivery</span> = <span style="color:#a6e22e">DeriveDeliveryFrom</span>(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">RouteSpecification</span>, <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">Itinerary</span>, <span style="color:#a6e22e">history</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// NewCargo creates a new, unrouted cargo.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewCargo</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">TrackingID</span>, <span style="color:#a6e22e">rs</span> <span style="color:#a6e22e">RouteSpecification</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">Cargo</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">itinerary</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">Itinerary</span>{}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">history</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">HandlingHistory</span>{make([]<span style="color:#a6e22e">HandlingEvent</span>, <span style="color:#ae81ff">0</span>)}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Cargo</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">TrackingID</span>:         <span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Origin</span>:             <span style="color:#a6e22e">rs</span>.<span style="color:#a6e22e">Origin</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">RouteSpecification</span>: <span style="color:#a6e22e">rs</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Delivery</span>:           <span style="color:#a6e22e">DeriveDeliveryFrom</span>(<span style="color:#a6e22e">rs</span>, <span style="color:#a6e22e">itinerary</span>, <span style="color:#a6e22e">history</span>),
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The cargo object is an entity that is concerned with the carrying out of business rules related to shipping cargo, such as route assignments and delivery progress. We abstract the saving and retrieving of the cargo using the repository pattern and creating an interface for the repository.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// CargoRepository provides access a cargo store.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">CargoRepository</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Store</span>(<span style="color:#a6e22e">cargo</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Cargo</span>) <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Find</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">TrackingID</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">Cargo</span>, <span style="color:#66d9ef">error</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">FindAll</span>() []<span style="color:#f92672">*</span><span style="color:#a6e22e">Cargo</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This interface is not given a concrete implementation at this step, instead, it is used in our use case through dependency injection in which the specific implementation will be chosen later. This is where our persistence technology will plug into. Notice how our application needs to know nothing about how cargo is persisted to use it, it is a detail we&rsquo;ll sort out later.</p>
<h3 id="use-cases">Use cases</h3>
<p>Our use cases are implemented by exposing a common use case interface for that particular use case and a hidden implementation that gets chosen using the factory pattern. That is to say, our use cases are expressed as interfaces with methods (actions) we can take. Use cases import only the inner layers of our application, such as the entities, and get injected with the concrete implementation of other interfaces like repositories and other uses cases.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Service is the interface that provides booking methods.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Service</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// BookNewCargo registers a new cargo in the tracking system, not yet</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// routed.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">BookNewCargo</span>(<span style="color:#a6e22e">origin</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">UNLocode</span>, <span style="color:#a6e22e">destination</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">UNLocode</span>, <span style="color:#a6e22e">deadline</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>) (<span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>, <span style="color:#66d9ef">error</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// LoadCargo returns a read model of a shipping.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">LoadCargo</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>) (<span style="color:#a6e22e">Cargo</span>, <span style="color:#66d9ef">error</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// RequestPossibleRoutesForCargo requests a list of itineraries describing</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// possible routes for this shipping.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">RequestPossibleRoutesForCargo</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>) []<span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Itinerary</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// AssignCargoToRoute assigns a cargo to the route specified by the</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// itinerary.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">AssignCargoToRoute</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>, <span style="color:#a6e22e">itinerary</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Itinerary</span>) <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// ChangeDestination changes the destination of a shipping.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ChangeDestination</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>, <span style="color:#a6e22e">destination</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">UNLocode</span>) <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Cargos returns a list of all cargos that have been booked.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Cargos</span>() []<span style="color:#a6e22e">Cargo</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Locations returns a list of registered locations.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Locations</span>() []<span style="color:#a6e22e">Location</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">service</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">cargos</span>         <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">CargoRepository</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">locations</span>      <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">LocationRepository</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">handlingEvents</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">HandlingEventRepository</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">routingService</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">RoutingService</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// NewService creates a booking service with necessary dependencies.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewService</span>(<span style="color:#a6e22e">cargos</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">CargoRepository</span>, <span style="color:#a6e22e">locations</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">LocationRepository</span>, <span style="color:#a6e22e">events</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">HandlingEventRepository</span>, <span style="color:#a6e22e">rs</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">RoutingService</span>) <span style="color:#a6e22e">Service</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">service</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">cargos</span>:         <span style="color:#a6e22e">cargos</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">locations</span>:      <span style="color:#a6e22e">locations</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">handlingEvents</span>: <span style="color:#a6e22e">events</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">routingService</span>: <span style="color:#a6e22e">rs</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">service</span>) <span style="color:#a6e22e">AssignCargoToRoute</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>, <span style="color:#a6e22e">itinerary</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Itinerary</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">id</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">||</span> len(<span style="color:#a6e22e">itinerary</span>.<span style="color:#a6e22e">Legs</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ErrInvalidArgument</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">cargos</span>.<span style="color:#a6e22e">Find</span>(<span style="color:#a6e22e">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">AssignToRoute</span>(<span style="color:#a6e22e">itinerary</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">cargos</span>.<span style="color:#a6e22e">Store</span>(<span style="color:#a6e22e">c</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">service</span>) <span style="color:#a6e22e">BookNewCargo</span>(<span style="color:#a6e22e">origin</span>, <span style="color:#a6e22e">destination</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">UNLocode</span>, <span style="color:#a6e22e">deadline</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>) (<span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">origin</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">destination</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">deadline</span>.<span style="color:#a6e22e">IsZero</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">ErrInvalidArgument</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">id</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">NextTrackingID</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">rs</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">RouteSpecification</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Origin</span>:          <span style="color:#a6e22e">origin</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Destination</span>:     <span style="color:#a6e22e">destination</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ArrivalDeadline</span>: <span style="color:#a6e22e">deadline</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">NewCargo</span>(<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">rs</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">cargos</span>.<span style="color:#a6e22e">Store</span>(<span style="color:#a6e22e">c</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">TrackingID</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">service</span>) <span style="color:#a6e22e">LoadCargo</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>) (<span style="color:#a6e22e">Cargo</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">id</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Cargo</span>{}, <span style="color:#a6e22e">ErrInvalidArgument</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">cargos</span>.<span style="color:#a6e22e">Find</span>(<span style="color:#a6e22e">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Cargo</span>{}, <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">assemble</span>(<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">handlingEvents</span>), <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//...</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Location is a read model for booking views.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Location</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">UNLocode</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;locode&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Name</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;name&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Cargo is a read model for booking views.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Cargo</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ArrivalDeadline</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>      <span style="color:#e6db74">`json:&#34;arrival_deadline&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Destination</span>     <span style="color:#66d9ef">string</span>         <span style="color:#e6db74">`json:&#34;destination&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Legs</span>            []<span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Leg</span> <span style="color:#e6db74">`json:&#34;legs,omitempty&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Misrouted</span>       <span style="color:#66d9ef">bool</span>           <span style="color:#e6db74">`json:&#34;misrouted&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Origin</span>          <span style="color:#66d9ef">string</span>         <span style="color:#e6db74">`json:&#34;origin&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Routed</span>          <span style="color:#66d9ef">bool</span>           <span style="color:#e6db74">`json:&#34;routed&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TrackingID</span>      <span style="color:#66d9ef">string</span>         <span style="color:#e6db74">`json:&#34;tracking_id&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this example, we have a booking use case that handles the booking of new cargo. Notice how in the constructor we are expressing the repository dependencies as arguments and do no instantiate our implementations. Instead, concrete implementations of these interfaces are passed on to us, injected, in the main package. We also don&rsquo;t pass entities in and out of this layer to the outside, instead, we receive and output DTOs that are specific to this use case. These DTOS are just simple structs with no logic which we transform into and from our internal entities and value objects. We do not cheat and pass out our entities because that would couple them to the needs of the outside world, and we want to shield our innermost layers from change.</p>
<p>Now, where do we put in the framework if we use one? We put them on the outside and include our use cases as dependencies. For example, in our booking cargo use case, we will have HTTP handlers for each method in the service interface.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">bookingHandler</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">booking</span>.<span style="color:#a6e22e">Service</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">kitlog</span>.<span style="color:#a6e22e">Logger</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">bookingHandler</span>) <span style="color:#a6e22e">router</span>() <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">Router</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">NewRouter</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Route</span>(<span style="color:#e6db74">&#34;/cargos&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">Router</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">bookCargo</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">listCargos</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Route</span>(<span style="color:#e6db74">&#34;/{trackingID}&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">Router</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">loadCargo</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/request_routes&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">requestRoutes</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/assign_to_route&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">assignToRoute</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/change_destination&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">changeDestination</span>)
</span></span><span style="display:flex;"><span>		})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/locations&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">listLocations</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Method</span>(<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;/docs&#34;</span>, <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StripPrefix</span>(<span style="color:#e6db74">&#34;/booking/v1/docs&#34;</span>, <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">FileServer</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Dir</span>(<span style="color:#e6db74">&#34;booking/docs&#34;</span>))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">r</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">bookingHandler</span>) <span style="color:#a6e22e">bookCargo</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ctx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">request</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Origin</span>          <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">UNLocode</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Destination</span>     <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">UNLocode</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ArrivalDeadline</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">NewDecoder</span>(<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Body</span>).<span style="color:#a6e22e">Decode</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">request</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;error&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">encodeError</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">w</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">id</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">BookNewCargo</span>(<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">Origin</span>, <span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">Destination</span>, <span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">ArrivalDeadline</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">encodeError</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">w</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">response</span> = <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ID</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span> <span style="color:#e6db74">`json:&#34;tracking_id&#34;`</span>
</span></span><span style="display:flex;"><span>	}{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ID</span>: <span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Header</span>().<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;Content-Type&#34;</span>, <span style="color:#e6db74">&#34;application/json; charset=utf-8&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">NewEncoder</span>(<span style="color:#a6e22e">w</span>).<span style="color:#a6e22e">Encode</span>(<span style="color:#a6e22e">response</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;error&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">encodeError</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">w</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this example, we are using the chi package to implement routing and include our booking service as a dependency. This layer has no application logic and only calls the appropriate methods on our use case, converting the raw data into and from dtos for our use case. When we instantiate our server implementation we pass in the use case implementations as arguments to the constructor.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Server holds the dependencies for a HTTP server.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Server</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Booking</span>  <span style="color:#a6e22e">booking</span>.<span style="color:#a6e22e">Service</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Tracking</span> <span style="color:#a6e22e">tracking</span>.<span style="color:#a6e22e">Service</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Handling</span> <span style="color:#a6e22e">handling</span>.<span style="color:#a6e22e">Service</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Logger</span> <span style="color:#a6e22e">kitlog</span>.<span style="color:#a6e22e">Logger</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">router</span> <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">Router</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// New returns a new HTTP server.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">bs</span> <span style="color:#a6e22e">booking</span>.<span style="color:#a6e22e">Service</span>, <span style="color:#a6e22e">ts</span> <span style="color:#a6e22e">tracking</span>.<span style="color:#a6e22e">Service</span>, <span style="color:#a6e22e">hs</span> <span style="color:#a6e22e">handling</span>.<span style="color:#a6e22e">Service</span>, <span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">kitlog</span>.<span style="color:#a6e22e">Logger</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">Server</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Server</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Booking</span>:  <span style="color:#a6e22e">bs</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Tracking</span>: <span style="color:#a6e22e">ts</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Handling</span>: <span style="color:#a6e22e">hs</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Logger</span>:   <span style="color:#a6e22e">logger</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">NewRouter</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">accessControl</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Route</span>(<span style="color:#e6db74">&#34;/booking&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">Router</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">h</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">bookingHandler</span>{<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Booking</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Logger</span>}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Mount</span>(<span style="color:#e6db74">&#34;/v1&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">router</span>())
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Route</span>(<span style="color:#e6db74">&#34;/tracking&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">Router</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">h</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">trackingHandler</span>{<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Tracking</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Logger</span>}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Mount</span>(<span style="color:#e6db74">&#34;/v1&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">router</span>())
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Route</span>(<span style="color:#e6db74">&#34;/handling&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">chi</span>.<span style="color:#a6e22e">Router</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">h</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">handlingHandler</span>{<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Handling</span>, <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Logger</span>}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Mount</span>(<span style="color:#e6db74">&#34;/v1&#34;</span>, <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">router</span>())
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Method</span>(<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;/metrics&#34;</span>, <span style="color:#a6e22e">promhttp</span>.<span style="color:#a6e22e">Handler</span>())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">router</span> = <span style="color:#a6e22e">r</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Notice, no logic relating to our use case is here, only logic to satisfy our framework an be a bridge between our use case and the framework. In this way, the core of our application knows nothing about what frameworks we use. It doesn&rsquo;t care at all. The framework could be changed two weeks from now and you wouldn&rsquo;t have to change a thing about the use case because of it. The only time use cases or entities might change is when business requirements change, never for technical reasons.</p>
<p>What about the repositories? Those are an outside-in thing that gets implemented elsewhere. When we choose a persistence technology we simply implement that interface and it gets passed into our use cases upon application startup. Here&rsquo;s a trivial, but important illustration, of an in-memory repository for our Cargo example.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Package inmem provides in-memory implementations of all the domain repositories.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">inmem</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;sync&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">shipping</span> <span style="color:#e6db74">&#34;github.com/marcusolsson/goddd&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">cargoRepository</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">mtx</span>    <span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">RWMutex</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">cargos</span> <span style="color:#66d9ef">map</span>[<span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>]<span style="color:#f92672">*</span><span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Cargo</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">cargoRepository</span>) <span style="color:#a6e22e">Store</span>(<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Cargo</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">mtx</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">mtx</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">cargos</span>[<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">TrackingID</span>] = <span style="color:#a6e22e">c</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">cargoRepository</span>) <span style="color:#a6e22e">Find</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Cargo</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">mtx</span>.<span style="color:#a6e22e">RLock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">mtx</span>.<span style="color:#a6e22e">RUnlock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">val</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">cargos</span>[<span style="color:#a6e22e">id</span>]; <span style="color:#a6e22e">ok</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">val</span>, <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">ErrUnknownCargo</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">cargoRepository</span>) <span style="color:#a6e22e">FindAll</span>() []<span style="color:#f92672">*</span><span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Cargo</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">mtx</span>.<span style="color:#a6e22e">RLock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">mtx</span>.<span style="color:#a6e22e">RUnlock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span> <span style="color:#f92672">:=</span> make([]<span style="color:#f92672">*</span><span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Cargo</span>, <span style="color:#ae81ff">0</span>, len(<span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">cargos</span>))
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">val</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">cargos</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">c</span> = append(<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">val</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">c</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// NewCargoRepository returns a new instance of a in-memory cargo repository.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewCargoRepository</span>() <span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">CargoRepository</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cargoRepository</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">cargos</span>: make(<span style="color:#66d9ef">map</span>[<span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">TrackingID</span>]<span style="color:#f92672">*</span><span style="color:#a6e22e">shipping</span>.<span style="color:#a6e22e">Cargo</span>),
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You can imagine that in a production environment you would implement this using SQL or some NoSQL database and build the entities up from serialized values. The repository implementation is responsible for rebuilding the objects from persistence, the entities don&rsquo;t care as long as they&rsquo;re built correctly.</p>
<h2 id="conclusion">Conclusion</h2>
<p>So what should you take away from all this? That you don&rsquo;t need a framework. That simply applying these principles will get you far and frameworks are just plugins into your application. I recommend that you study these principles and practices more in-depth and stop thinking in terms of frameworks but in terms of your domain. What is it that you&rsquo;re trying to accomplish and build that, don&rsquo;t focus on the tools.</p>
<p>To see the entire code, go to the <a href="https://github.com/marcusolsson/goddd/">GoDDD repository</a> where a complete example of DDD in Go lives.</p>
<p>Also, check out the talks given by Uncle Bob on clean architecture. He&rsquo;s the OG when it comes to clean code and maintainability these days. Fair warning, he does tend to ramble a lot during the beginning of those talks with interesting anecdotes, but they&rsquo;re always fun to watch. He&rsquo;s also written several books you should check out on clean code and architecture.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=2dKZ-dWaCiU&amp;t=1290s">ITkonekt 2019 | Robert C. Martin (Uncle Bob), Clean Architecture and Design</a></li>
<li><a href="https://www.youtube.com/watch?v=NeXQEJNWO5w">Uncle Bob Martin - The Clean Coder</a></li>
<li><a href="https://www.youtube.com/watch?v=o_TH-Y78tt4">The Principles of Clean Architecture by Uncle Bob Martin</a></li>
<li><a href="https://www.youtube.com/watch?v=Nsjsiz2A9mg">Robert C Martin - Clean Architecture and Design</a></li>
</ul>
<p>Finally, check out the topics of Domain-Driven Design and SOLID. They will change the way you architect your applications, I guarantee it.</p>
]]></content>
        </item>
        
        <item>
            <title>Event Sourcing in Go</title>
            <link>https://victoramartinez.com/posts/event-sourcing-in-go/</link>
            <pubDate>Mon, 23 Mar 2020 21:13:59 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/event-sourcing-in-go/</guid>
            <description>&lt;p&gt;I&amp;rsquo;ve recently gone into doing CQRS with event sourcing along with DDD (Domain Driven Design) principles. I&amp;rsquo;ve been doing it in Go and want to share how I do it.&lt;/p&gt;
&lt;p&gt;To begin with, I&amp;rsquo;ve researched this topic thoroughly; I&amp;rsquo;ve probably watched and re-watched hundreds of videos and read many posts, articles, and books on it. I am by no means a cqrs/es expert, but I have gained some insight into how to do it. The first thing I want to put out there is that you don&amp;rsquo;t need a framework to do this. Ddd and cqrs/es are best done without a framework getting in the way and instead you should create a &lt;a href=&#34;https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html&#34;&gt;Clean Architecture&lt;/a&gt; where the framework you choose later on becomes a sort of plugin into your application.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>I&rsquo;ve recently gone into doing CQRS with event sourcing along with DDD (Domain Driven Design) principles. I&rsquo;ve been doing it in Go and want to share how I do it.</p>
<p>To begin with, I&rsquo;ve researched this topic thoroughly; I&rsquo;ve probably watched and re-watched hundreds of videos and read many posts, articles, and books on it. I am by no means a cqrs/es expert, but I have gained some insight into how to do it. The first thing I want to put out there is that you don&rsquo;t need a framework to do this. Ddd and cqrs/es are best done without a framework getting in the way and instead you should create a <a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html">Clean Architecture</a> where the framework you choose later on becomes a sort of plugin into your application.</p>
<p>So what is &ldquo;event sourcing&rdquo;? Simply put, event sourcing is a pattern by which the current state is derived from previous facts (events). That is to say, to get the current state of an object you replay all the events of an object in memory to rebuild it from the actions you took previously. And you must accept these previous actions as fact, that is they already happened and you can&rsquo;t change it. You can change your mind about what a fact means to you in the future, but you can&rsquo;t change the fact or that it happened. New events are emitted when new actions are taken and that gets saved into the event store. The only unit of persistence in an event-sourced application is the events, everything else is a projection of those events or more correctly a cache.</p>
<p>Events are emitted by aggregates who are composed of one or more entities. The repository for those aggregates is responsible for saving those events into the event store.</p>
<p>Where do these events come from? They come from the initial design of the system through various exercises such as event storming, a process by which the overall process or sub-process of an application is discovered and modeled as events that have happened. Keep in mind, these aren&rsquo;t fine-grained low-level events like you might be used to in GUI programming, such as a user clicked event, they&rsquo;re more coarse than that. Take the example of a system that deals with hospital admissions of a patient, let us model the interactions the patient has in the system with events. A patient might first be admitted into the hospital, we might say we have a &ldquo;Patient Admitted&rdquo; event; notice the past perfect tense. Later on, when a patient is transferred to another ward we say that we have a &ldquo;Patient Transferred&rdquo; event. Finally, when a patient gets discharged we have &ldquo;Patient Discharged&rdquo;. These events arose out of the need to describe what has happened to a patient.</p>
<p>These events are created through the use of commands in the command query responsibility segregation pattern. Commands signify intent that an action should be taken, but with no guarantee that they will. A command handler can reject commands and produce no events. There are many ways to model commands in a system. They can be as simple as imperative methods that tell an object what to do or as DTOs that have the data in them needed to carry out the command. In my case, I chose to make it as simple as a method on an object.</p>
<p>So with all this, what does it all look like in Go? To begin let&rsquo;s look at what an event might look like in Go. Let&rsquo;s use our patient example.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">patient</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Event is a domain event marker.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Event</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">isEvent</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#a6e22e">PatientAdmitted</span>) <span style="color:#a6e22e">isEvent</span>()    {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#a6e22e">PatientTransferred</span>) <span style="color:#a6e22e">isEvent</span>() {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">e</span> <span style="color:#a6e22e">PatientDischarged</span>) <span style="color:#a6e22e">isEvent</span>() {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// PatientAdmitted event.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">PatientAdmitted</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ID</span>   <span style="color:#a6e22e">ID</span>         <span style="color:#e6db74">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Name</span> <span style="color:#a6e22e">Name</span>       <span style="color:#e6db74">`json:&#34;name&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Ward</span> <span style="color:#a6e22e">WardNumber</span> <span style="color:#e6db74">`json:&#34;ward&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Age</span>  <span style="color:#a6e22e">Age</span>        <span style="color:#e6db74">`json:&#34;age&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// PatientTransferred event.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">PatientTransferred</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ID</span>            <span style="color:#a6e22e">ID</span>         <span style="color:#e6db74">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">NewWardNumber</span> <span style="color:#a6e22e">WardNumber</span> <span style="color:#e6db74">`json:&#34;new_ward&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// PatientDischarged event.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">PatientDischarged</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ID</span> <span style="color:#a6e22e">ID</span> <span style="color:#e6db74">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Notice how the events are simply going structs which reference the id of the aggregate they&rsquo;re related to. There is also a marker interface that is implemented by them by way of a single un-exported method; this is to prevent outside structs from being flagged as possible events from this package and also to limit the scope of what counts as an event for this application.</p>
<p>Next, we turn to our aggregate, which looks like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">patient</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Patient aggregate.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Patient</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">id</span>         <span style="color:#a6e22e">ID</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ward</span>       <span style="color:#a6e22e">WardNumber</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">name</span>       <span style="color:#a6e22e">Name</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">age</span>        <span style="color:#a6e22e">Age</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">discharged</span> <span style="color:#66d9ef">bool</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">changes</span> []<span style="color:#a6e22e">Event</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">version</span> <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// NewFromEvents is a helper method that creates a new patient</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// from a series of events.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewFromEvents</span>(<span style="color:#a6e22e">events</span> []<span style="color:#a6e22e">Event</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Patient</span>{}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">event</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">events</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">On</span>(<span style="color:#a6e22e">event</span>, <span style="color:#66d9ef">false</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Ward returns the patient&#39;s ward number.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">Ward</span>() <span style="color:#a6e22e">WardNumber</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">ward</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Name returns the patient&#39;s name.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">Name</span>() <span style="color:#a6e22e">Name</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">name</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Age returns the patient&#39;s age.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">Age</span>() <span style="color:#a6e22e">Age</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">age</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Discharged returns wether or not the patient has been discharged.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">Discharged</span>() <span style="color:#66d9ef">bool</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">discharged</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ID returns the id of the patient. Duh.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">ID</span>() <span style="color:#a6e22e">ID</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">id</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// New creates a new Patient from id, name, age and ward number.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">ID</span>, <span style="color:#a6e22e">name</span> <span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">age</span> <span style="color:#a6e22e">Age</span>, <span style="color:#a6e22e">ward</span> <span style="color:#a6e22e">WardNumber</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Patient</span>{}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">raise</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">PatientAdmitted</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ID</span>:   <span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Name</span>: <span style="color:#a6e22e">name</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Age</span>:  <span style="color:#a6e22e">age</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Ward</span>: <span style="color:#a6e22e">ward</span>,
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Transfer transfers a patient to a new ward.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">Transfer</span>(<span style="color:#a6e22e">newWard</span> <span style="color:#a6e22e">WardNumber</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">discharged</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ErrPatientDischarged</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">raise</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">PatientTransferred</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ID</span>:            <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">NewWardNumber</span>: <span style="color:#a6e22e">newWard</span>,
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Discharge discharges a patient</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">Discharge</span>() <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">discharged</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ErrPatientDischarged</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">raise</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">PatientDischarged</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ID</span>: <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// On handles patient events on the patient aggregate.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">On</span>(<span style="color:#a6e22e">event</span> <span style="color:#a6e22e">Event</span>, <span style="color:#a6e22e">new</span> <span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">event</span>.(<span style="color:#66d9ef">type</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">PatientAdmitted</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">id</span> = <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ID</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">age</span> = <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">Age</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">ward</span> = <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">Ward</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">PatientDischarged</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">discharged</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">PatientTransferred</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">ward</span> = <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">NewWardNumber</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">new</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">version</span><span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Events returns the uncommitted events from the patient aggregate.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">Events</span>() []<span style="color:#a6e22e">Event</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">changes</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Version returns the last version of the aggregate before changes.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">Version</span>() <span style="color:#66d9ef">int</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">version</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">raise</span>(<span style="color:#a6e22e">event</span> <span style="color:#a6e22e">Event</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">changes</span> = append(<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">changes</span>, <span style="color:#a6e22e">event</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">On</span>(<span style="color:#a6e22e">event</span>, <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You&rsquo;ll notice a few things. First, the use of private fields in the aggregate is to protect our invariants. Then you&rsquo;ll notice that each method that raises an event does not change state directly, but instead raises an event first and that gets handled by the aggregate&rsquo;s <code>On</code> method. The <code>On</code> method is in charge of rebuilding the state from an event. It does a type switch on the event and caries out the behavior accordingly. Let&rsquo;s look at a single method closely.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Transfer transfers a patient to a new ward.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">Transfer</span>(<span style="color:#a6e22e">newWard</span> <span style="color:#a6e22e">WardNumber</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">discharged</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ErrPatientDischarged</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">raise</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">PatientTransferred</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ID</span>:            <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">NewWardNumber</span>: <span style="color:#a6e22e">newWard</span>,
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Notice how the <code>Transfer</code> method first checks if the patient has already been discharged before emitting the event. We first have to check the business rules are satisfied before emitting the appropriate event, otherwise, we reject the command and return an error. If all is well, we simply raise the event which gets handled by the <code>On</code> method and we return nil. We do not change state unless all of the conditions are satisfied.</p>
<p>Let&rsquo;s look at the <code>On</code> and <code>raise</code> methods more closely.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// On handles patient events on the patient aggregate.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">On</span>(<span style="color:#a6e22e">event</span> <span style="color:#a6e22e">Event</span>, <span style="color:#a6e22e">new</span> <span style="color:#66d9ef">bool</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">event</span>.(<span style="color:#66d9ef">type</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">PatientAdmitted</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">id</span> = <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">ID</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">age</span> = <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">Age</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">ward</span> = <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">Ward</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">PatientDischarged</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">discharged</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">PatientTransferred</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">ward</span> = <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">NewWardNumber</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">new</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">version</span><span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span>) <span style="color:#a6e22e">raise</span>(<span style="color:#a6e22e">event</span> <span style="color:#a6e22e">Event</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">changes</span> = append(<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">changes</span>, <span style="color:#a6e22e">event</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">On</span>(<span style="color:#a6e22e">event</span>, <span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Notice, the On method first does a type switch on the event and selects the case for each event type. This is where state change happens. Once an event is emitted and saved we do not throw an error, we simply process the event and carry on. We can change here if we decide that an event is no longer relevant or if it means something different, but we can&rsquo;t return an error and say an event is invalid. Then we check if this is a new event if it isn&rsquo;t we increment the version number of our aggregate. The <code>raise</code> method does two things, it appends the event into our changes slice and calls the event handler <code>On</code> saying that this is a new event and we should not increment the version number. Wait, what&rsquo;s this about the version? The version is an optimistic concurrency pattern used to help us avoid database locks to change our aggregate.</p>
<p>So let&rsquo;s look at how we might use this aggregate. First, we have a repository that saves and retrieves the aggregate from the event store and we also have a service that represents a particular use case.</p>
<p>One method on the service might look like this. We first load up the aggregate by replaying the events, we execute the command and save it to the repository. Simple, no?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">service</span>) <span style="color:#a6e22e">TransferPatient</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">ID</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">newWard</span> <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">WardNumber</span>,
</span></span><span style="display:flex;"><span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">repo</span>.<span style="color:#a6e22e">Load</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Transfer</span>(<span style="color:#a6e22e">newWard</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">repo</span>.<span style="color:#a6e22e">Save</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">p</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Well, things aren&rsquo;t so simple for our repository implementation. Here, I&rsquo;ve come up with a way to save them to dynamodb using some helper libraries from a project called <a href="https://github.com/altairsix/eventsource">eventsource</a> by using embedded structs to serialize and deserialize the event objects to and from JSON. (The LINQ like syntax comes from a library called <a href="https://github.com/ahmetb/go-linq">go-linq</a>)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">repository</span>) <span style="color:#a6e22e">Load</span>(
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">id</span> <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">ID</span>,
</span></span><span style="display:flex;"><span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Patient</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// load up all events</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">records</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">Load</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">String</span>(), <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">events</span> <span style="color:#f92672">:=</span> []<span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Event</span>{}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">linq</span>.<span style="color:#a6e22e">From</span>(<span style="color:#a6e22e">records</span>).
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">SelectT</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">record</span> <span style="color:#a6e22e">eventsource</span>.<span style="color:#a6e22e">Record</span>) <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Event</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">typed</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">Type</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;event_type&#34;`</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Unmarshal</span>(<span style="color:#a6e22e">record</span>.<span style="color:#a6e22e">Data</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">typed</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">e</span> <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Event</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">typed</span>.<span style="color:#a6e22e">Type</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">eventName</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientAdmitted</span>{}):
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">e</span> = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientAdmitted</span>{}
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">eventName</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientTransferred</span>{}):
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">e</span> = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientTransferred</span>{}
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">eventName</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientDischarged</span>{}):
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">e</span> = <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientDischarged</span>{}
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Unmarshal</span>(<span style="color:#a6e22e">record</span>.<span style="color:#a6e22e">Data</span>, <span style="color:#a6e22e">e</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">e</span>
</span></span><span style="display:flex;"><span>		}).
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ToSlice</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">events</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">NewFromEvents</span>(<span style="color:#a6e22e">events</span>), <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">repository</span>) <span style="color:#a6e22e">Save</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">p</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Patient</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">records</span> <span style="color:#f92672">:=</span> make([]<span style="color:#a6e22e">eventsource</span>.<span style="color:#a6e22e">Record</span>, len(<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Events</span>()))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">linq</span>.<span style="color:#a6e22e">From</span>(<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Events</span>()).
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">SelectT</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">event</span> <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Event</span>) <span style="color:#a6e22e">eventsource</span>.<span style="color:#a6e22e">Record</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">data</span> []<span style="color:#66d9ef">byte</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">e</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">event</span>.(<span style="color:#66d9ef">type</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientAdmitted</span>:
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Marshal</span>(<span style="color:#a6e22e">admitted</span>{
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">Type</span>:           <span style="color:#a6e22e">eventName</span>(<span style="color:#a6e22e">e</span>),
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">PatientAdmitted</span>: <span style="color:#a6e22e">e</span>,
</span></span><span style="display:flex;"><span>				})
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientDischarged</span>:
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Marshal</span>(<span style="color:#a6e22e">discharged</span>{
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">Type</span>:              <span style="color:#a6e22e">eventName</span>(<span style="color:#a6e22e">e</span>),
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">PatientDischarged</span>: <span style="color:#a6e22e">e</span>,
</span></span><span style="display:flex;"><span>				})
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientTransferred</span>:
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Marshal</span>(<span style="color:#a6e22e">transferred</span>{
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">Type</span>:              <span style="color:#a6e22e">eventName</span>(<span style="color:#a6e22e">e</span>),
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">PatientTransferred</span>: <span style="color:#a6e22e">e</span>,
</span></span><span style="display:flex;"><span>				})
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">eventsource</span>.<span style="color:#a6e22e">Record</span>{
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">Data</span>: <span style="color:#a6e22e">data</span>,
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}).
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ToSlice</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">records</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">records</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">expectedVersion</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Version</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">records</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">Version</span> = <span style="color:#a6e22e">expectedVersion</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">Save</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">ID</span>().<span style="color:#a6e22e">String</span>(), <span style="color:#a6e22e">records</span><span style="color:#f92672">...</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">admitted</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Type</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;event_type&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">*</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientAdmited</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">transferred</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Type</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;event_type&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">*</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientTransferred</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">discharged</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Type</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;event_type&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">*</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">PatientDischarged</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">eventName</span>(<span style="color:#a6e22e">event</span> <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Event</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">t</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">TypeOf</span>(<span style="color:#a6e22e">event</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Kind</span>() <span style="color:#f92672">==</span> <span style="color:#a6e22e">reflect</span>.<span style="color:#a6e22e">Ptr</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">t</span> = <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Elem</span>()
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Name</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In the <code>Save</code> method, you&rsquo;ll notice we extract the events from the aggregate, convert them to JSON and give them a version number, starting from the last version the aggregate was at. The version number is important for optimistic concurrency as we check before we save that there are no events with those versions before we save. If there are, we&rsquo;ve been beaten by another command handler and need to reject, because we are stale.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">records</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">expectedVersion</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Version</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">records</span>[<span style="color:#a6e22e">i</span>].<span style="color:#a6e22e">Version</span> = <span style="color:#a6e22e">expectedVersion</span>
</span></span><span style="display:flex;"><span>	}
</span></span></code></pre></div><p>When we load up the aggregate, we first load up all events in order and replay them back into the aggregate.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">repository</span>) <span style="color:#a6e22e">Load</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">id</span> <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">ID</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Patient</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>     <span style="color:#75715e">// load up all events</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">records</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">store</span>.<span style="color:#a6e22e">Load</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">id</span>.<span style="color:#a6e22e">String</span>(), <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">events</span> <span style="color:#f92672">:=</span> []<span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Event</span>{}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">linq</span>.<span style="color:#a6e22e">From</span>(<span style="color:#a6e22e">records</span>).
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">SelectT</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">record</span> <span style="color:#a6e22e">eventsource</span>.<span style="color:#a6e22e">Record</span>) <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">Event</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// convert from record to domain event...</span>
</span></span><span style="display:flex;"><span>		}).
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ToSlice</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">events</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Replay the events</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">patient</span>.<span style="color:#a6e22e">NewFromEvents</span>(<span style="color:#a6e22e">events</span>), <span style="color:#66d9ef">nil</span> 
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In the aggregate&rsquo;s package, I&rsquo;ve chosen to have a helper method that replays all events for us.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// NewFromEvents is a helper method that creates a new patient</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// from a series of events.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewFromEvents</span>(<span style="color:#a6e22e">events</span> []<span style="color:#a6e22e">Event</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">Patient</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Patient</span>{}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">event</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">events</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">On</span>(<span style="color:#a6e22e">event</span>, <span style="color:#66d9ef">false</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>All this does is call our <code>On</code> method by passing false to the new flag.</p>
<p>With all that we now have an event sourced aggregate in Go. We didn&rsquo;t need a framework to do this, the go standard library was enough and I think you can figure out how to change or add what you need in the future.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Should you use event sourcing? That depends on your project and if the added complexity of adding event sourcing is warranted. I will say, that most simple applications don&rsquo;t, but that many will have some breakthroughs by applying this pattern. Let me hear your thoughts on this pattern. I&rsquo;ve seen incredible success with this pattern, especially in systems of various microservices where another microservice and get notifications of things that have happened in another by just reading the event stream of another service instead of asking them directly. So I see this going a lot of places and think I&rsquo;ll be doing this more in the future.</p>
]]></content>
        </item>
        
        <item>
            <title>What I&#39;ve Learned Working in a Large Software Project</title>
            <link>https://victoramartinez.com/posts/learnings-working-large-software-project/</link>
            <pubDate>Thu, 28 Nov 2019 20:46:11 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/learnings-working-large-software-project/</guid>
            <description>&lt;p&gt;I&amp;rsquo;ve been working my first large software project for almost a year now and I&amp;rsquo;d like to share my learnings from this project. The things I&amp;rsquo;ve learned, discovered, and realized during this time might be interesting to some, might be old news to others, and might even shed some light on how certain things are done in certain types of projects, but all in all I hope this proves to be an interesting read.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>I&rsquo;ve been working my first large software project for almost a year now and I&rsquo;d like to share my learnings from this project. The things I&rsquo;ve learned, discovered, and realized during this time might be interesting to some, might be old news to others, and might even shed some light on how certain things are done in certain types of projects, but all in all I hope this proves to be an interesting read.</p>
<p>First things first, where have I been working? I&rsquo;m currently a software developer at the <a href="https://suri.hacienda.pr.gov">SURI</a> project, the current largest government software project for the Puerto Rico government under the arm of the Treasury Department, also known as Hacienda. This is the software that is going to handle all the new tax related activities for the treasury and is already being used for corporate tax returns, import declarations, and other tax activities. Next year the plan is to rollout the individual tax returns. We already handle individuals in the system, but only show informative and W2s and not their tax returns yet. I&rsquo;m here as a contractor on behalf of my employer.</p>
<p>Here are some of the things I&rsquo;ve learned while working here and some of the things I&rsquo;ve discovered when comparing to other jobs, positions, and projects I&rsquo;ve been in or have compared to.</p>
<h2 id="automated-deploys">Automated Deploys</h2>
<p>Once you&rsquo;re done developing and testing your components in a large project like this, it is very important that you have a setup a reliable automated deployment framework. In the SURI project we have such a system that&rsquo;s setup by Fast Enterprises FCR product. Once final testing in done we create a migration script using the internal tools that takes all the component over to the production environment. The same goes for our testing and staging environments. I don&rsquo;t think we could be as productive as we are without this. Having to manually move things around is a pain and having an automated system to this is really quite helpful. Now, our teams have specific times of day and during the week when things are deployed. Deployment to the testing and staging environment happen every four hours or so on a schedule and production happens at the end of day every day for urgent items and every Wednesday for everything else. One thing to note tho, in our system we still choose which components or configuration to move manually. It&rsquo;s something that I personally dislike, at least in terms of components, but it works well and I can see the advantages of this method. I&rsquo;d personally like to see truly automated deploys to the testing and staging environments,but that would require an additional and I believe necessary change in order to this effectively. Which brings me to the following&hellip;</p>
<h2 id="testing-and-the-meat-cloud">Testing and The Meat Cloud</h2>
<p>In SURI, being a government project, there&rsquo;s a lot of people involved. Almost of a quarter of those people are testers. These testers do&hellip; well exactly what you&rsquo;d think they do, they test the software. The way we test in SURI is that developers write manual test scenarios once we&rsquo;re done with development and then the scenarios are assigned out to testers. This way of testing while necessary at some point, like in QA, just doesn&rsquo;t sit well with me for several reasons. First reason being that these testers are human and humans forget things or don&rsquo;t always do things in a reproducible manner. Now granted, we have some great testers in the team and they do an amazing job, but I think that for many of the tests we do we could do a lot better. These testers are also a phenomenon I like to call the meat cloud. The meat cloud is just a bunch of people you hire to do certain tasks instead of doing them with computers. I don&rsquo;t dislike the meat cloud, it&rsquo;s definitely something that&rsquo;s okay for instances where the automation is not there yet, but in the instance of testing and especially unit testing, we could do better.</p>
<p>Automated unit testing in a project of this size would not only be beneficial, but I&rsquo;d argue necessary to ensure a level of quality and productivity that is required. The kind of software we write here is something that I would consider a great fit for automated testing and even TDD. As and example, most of the components deal with processing returns, flat files, and simple business rules, many of which are perfect candidates for automated unit testing of the &ldquo;given x then y expect z&rdquo; nature. One of the types of components our framework uses is called a Document, this document has a very simple structure, it&rsquo;s just a bunch of fields with excel-like rules and functions. These fields simply take input and produce certain output and validate that input against a simple set of rules. One could easily test these using automated unit tests as it would just be a matter of giving it certain input and expecting a certain output or end state. For the other types of components, what we in SURI call the business objects, testing would not be as simple, but still would of a similar nature. Many of the business objects could be tested using similar unit testing techniques including BDD techniques. The advantage of such a method of automated testing would be that 1. the code and way of usage would be self documenting as the tests would be the design or be heavily influenced by the design and requirements, 2. you would be made aware quickly of any breaking changes you&rsquo;ve introduced while fixing the software or adding new features, and 3. if you had a set of dependable, automated, and clear unit tests in a test suite, you could be more confident in your ability to deploy code that works well and has the least amount of bugs. But what if you miss something? What if you forget to test a specific scenario? Well, you can always just add the test later on. Wouldn&rsquo;t you then need tests for the tests? First of all, no, ideally your tests are small and concise and need no tests for themselves as they are very small. Secondly this is very common rebuttal to unit testing and TDD, or at the very least misconception, but it&rsquo;s totally false.</p>
<p>So why else have automated testing, well that ties in to the first thing I mentioned. Which is that it allows for better more reliable automated deploys. It only takes the system to test before it deploys to choose which components go up. I don&rsquo;t know about you, but if I have to do one less thing at work that isn&rsquo;t related to developing I think that&rsquo;s a win-win. Because again, as a human, I can miss things, having this would make sure I miss less things.</p>
<h2 id="the-importance-of-code-review">The Importance of Code Review</h2>
<p>One of the old adages of software development is that the more eyes on a project, the more bugs are found and eliminated, and the better the software becomes overall. This still holds true and will continue to be. This why code review is so important and in SURI this is no exception. Once we&rsquo;ve finished our work in progress tasks se send it off to be code reviewed by one of the team leads. These leads, having work on the project for a longer time or been involved with it&rsquo;s initial development, review the code (duh) and give the go-ahead for testing, migration, and finally deployment to production. They&rsquo;re job in this role is to make sure that we haven&rsquo;t miss anything important and to suggest better fixes, better ways of doing things, and that our code and changes are in line with the standards we use throughout the project. This is a step that is necessary in all software projects after a certain size, and I would argue that if you&rsquo;re team gets bigger than one, then you need code review in your pipeline.</p>
<p>Previously I&rsquo;ve worked in projects that haven&rsquo;t had code reviews and they suffered in quality as a result. The lack of useful eyes on a piece of software leads to often software that lacks in many things, most of all in quality.</p>
<h2 id="databases-and-data-duplication">Databases and Data Duplication</h2>
<p>Data duplication is okay. Let me say that again, duplicating data is okay. Not only is it okay, it is often necessary for software to be responsive and to offer a good user experience. We duplicate data all the time in our systems and it&rsquo;s myth that you should not duplicate data at all. You&rsquo;d often read in common database class textbooks and lectures that one of the reasons we use databases is to eliminate data duplication and that we should avoid it. While that is good advice for some, it is absolutely the worst piece of advice for big systems. Often one place where we duplicate data is when we want to provide different types of queries or we want faster queries, so we duplicate the data in the format we&rsquo;re going to query it, effectively denormalizing the data. This is okay, because it&rsquo;s a tradeoff we make to ensure the system is fast. One thing should be clear, tho, the flow of data is still one way. Data is only written in one way and everything else trickles down from that flow. When a return document is submitted for example, only one system in charge of processing that return, once that return is processed events are triggered that might take that return document and do several things with it, like mapping certain fields to a denormalized table, create transactions off of it, produce letters, etc. This process gets triggered all over again when a new version is crated such as with and amendment, so even tho we duplicate data, the data is eventually always consistent because we do not modify the duplicated data, instead it is derived from the original source.</p>
<p>What does this give us? Well let&rsquo;s say you need to figure out how many people issued a return for more than $200,000 in business volume, with this setup you could just have a mapping table for the fields you&rsquo;re interested in that gets updated whenever the document changes and you&rsquo;d query that for your report, the alternative would be to open each and every document, load it into memory, and you can see how complicated and constraining it will get. Think if it as recalculating the results in a way.</p>
<p>So you can see that duplicating the data isn&rsquo;t such a big problem. Sure you will end up in scenarios where the data is updated, but this is mitigated against by having only one place that is in charge of changing it and therefore you isolate that transaction there.</p>
<h2 id="business">Business</h2>
<p>More than anything we write software for people, and that&rsquo;s even more true in the case of SURI. It is important then to have a good relationship with the people familiar with the business, because they have all the expert knowledge you need to write the software for the people who will eventually use it. When you write software, you&rsquo;re writing for people and the business. The real job of a programmer is to solve problems using a computer, the computer part is secondary to the job. What tools you use, how you do it, and all that other stuff is important, but not more important than solving the problems of the business. We&rsquo;re engineers of a different breed, ones that work with logic, switches, instructions, and processes, instead of with cogs, gears, bridges, or cement, but in the end we all build for people.</p>
<p>The way we interact with the business in the SURI project is very interesting. On site we have several people who manage the project who are experts in specific areas, such as corporate returns and declarations, audits, levies, etc. These experts give us specifications for new features, bug fixes, and new versions of existing features. The way it works is that they raise new issue (we call them SQRs) with descriptions of what needs to be done. Sometimes their descriptions are accurate enough to be able to do the work without asking them for further clarification, but often we seek them out in a short face to face meeting to get a better picture of the issue to be solved in their words, and our jobs is to translate that into code or fixes to the software. Without these people, we would literally have no job.</p>
<h2 id="conclusions">Conclusions</h2>
<p>So I&rsquo;ve learned a lot while working here and it&rsquo;s only been about a year (maybe more by the time you read this), and a lot of it has been very valuable to my future development in my career. I consider that I&rsquo;ll be more valuable after exiting this project and I think you&rsquo;d agree. Anyways, I really don&rsquo;t know how to end this blog post other than maybe asking what you might have learned during your current job or better yet your first job experience in a big project. I&rsquo;m also open to any questions or further clarification about what I&rsquo;ve written up here. This is in no way meant as a rant or as a critique, as in a bad review, of my current position, but as an observation of what I&rsquo;ve been doing and learning over the past year. So with that, let me know what you think and I look forward to writing the next one.</p>
]]></content>
        </item>
        
        <item>
            <title>WTF is Blockchain?</title>
            <link>https://victoramartinez.com/posts/wtf-is-blockchain/</link>
            <pubDate>Tue, 07 Aug 2018 19:44:17 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/wtf-is-blockchain/</guid>
            <description>&lt;p&gt;This post was inspired by a talk given by Jared Haight from Microsoft at &lt;a href=&#34;http://bsidespr.org/2017/&#34;&gt;BSidesPR&lt;/a&gt;. Jared talked about giving back to the InfoSec community at a large, and he mentioned things to write about, including Blockchain. Specifically, he asked &amp;ldquo;WTF is Blockchain?&amp;rdquo; and said it that if you actually title it like that, he&amp;rsquo;d read it. So, this is my attempt at writing that description.&lt;/p&gt;
&lt;h4 id=&#34;tldr-blockchain-is-an-unchangeable-series-of-blocks-that-each-reference-the-previous-blocks-contents-via-a-hash-of-that-content-blocks-are-a-collection-of-transactions-that-have-been-grouped-together-by-miners&#34;&gt;TLDR: Blockchain is an unchangeable series of blocks that each reference the previous&amp;rsquo; block&amp;rsquo;s contents via a hash of that content. Blocks are a collection of transactions that have been grouped together by miners.&lt;/h4&gt;
&lt;h1 id=&#34;basic-computer-science&#34;&gt;Basic Computer Science&lt;/h1&gt;
&lt;p&gt;To really understand blockchain techonlogy you must first understand a few computer science concepts. Don&amp;rsquo;t worry, I wont bore you with the details.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>This post was inspired by a talk given by Jared Haight from Microsoft at <a href="http://bsidespr.org/2017/">BSidesPR</a>. Jared talked about giving back to the InfoSec community at a large, and he mentioned things to write about, including Blockchain. Specifically, he asked &ldquo;WTF is Blockchain?&rdquo; and said it that if you actually title it like that, he&rsquo;d read it. So, this is my attempt at writing that description.</p>
<h4 id="tldr-blockchain-is-an-unchangeable-series-of-blocks-that-each-reference-the-previous-blocks-contents-via-a-hash-of-that-content-blocks-are-a-collection-of-transactions-that-have-been-grouped-together-by-miners">TLDR: Blockchain is an unchangeable series of blocks that each reference the previous&rsquo; block&rsquo;s contents via a hash of that content. Blocks are a collection of transactions that have been grouped together by miners.</h4>
<h1 id="basic-computer-science">Basic Computer Science</h1>
<p>To really understand blockchain techonlogy you must first understand a few computer science concepts. Don&rsquo;t worry, I wont bore you with the details.</p>
<h2 id="linked-lists-and-merkle-trees">Linked Lists and Merkle Trees</h2>
<p>At the heart of blockchain is the concept of Linked Lists and Merkle Trees. A linked list consists of many simple datastructure elements that contain of a value and a pointer. The pointer &ldquo;points&rdquo; to another element in the linked list, usually the next one in the list. Linked List elements can point to the next or the previous element or both.</p>
<p><img src="https://steemitimages.com/DQmQRFECQN5yQNGRmwh2yEBHUGiHgVPNKmr8kbJRCYTT5jY/single-list.png" alt="Linked List"></p>
<p>Simple enough, right? All you really need to know is that Linked Lists are a collection of elements that each point to the next element or the previous.</p>
<p>A Merkle Tree is similar in construction to a Linked List except that each element has two children instead of a previous and next element. This datastructure is used to construct hashes out of smaller hashes. A hash is a cryptographic number that is used to identify some arbitrary data. A Merkle Tree is useful because you can send someone the complete hash and the sub hashes and then verify yourself that the complete hash can be built out of the subhashes. This adds security without trust.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Hash_Tree.svg/1200px-Hash_Tree.svg.png" alt="Merkle Tree"></p>
<p>Each subhash is built out of distinct data blocks. In many blockchain implementations the hashes are usually SHA 256 or above.</p>
<h1 id="blockchain-a-chain-of-blocks-and-proof-of-work">Blockchain: A chain of blocks and proof of work</h1>
<p><img src="https://s3.amazonaws.com/cbi-research-portal-uploads/2017/11/20155651/112017-Blockchain-4-V2.png" alt="Decentralized Ledger">
The basic building block of blockchain (no pun intended) is a Block. A Block is a collection of transactions that need to stored. Along with the transactions the Block usually contains a few more things that make it immutable (i.e. unchangable). These are the hash of the previous block, something called a nonce number, and the hash of the current block. But how does that hash get generated and what makes it immuatable? Well that hash has to include the contents of the block, the nonce number and the hash of the previous block. The hash also has to match a specific pattern which is very hard to find. In order to find that pattern you must keep incrementing the nonce number in order for the hash to become a certain pattern. Once that pattern is found it is said to be the proof of work for that block. A proof of work is one of the ways many blockchains make sure that blocks have not been tampered with, because generating a cryptographic hash matching a certain pattern that uses the contents of a block is very hard to find. Because it is very hard to find it is a great way to even the playing field when it comes to finding that magic number because everyone has a chance to find it. One added security to this is making the pattern harder to find depending on the number of members in the network.</p>
<h1 id="proof-of-work--incentives">Proof of Work:  Incentives!</h1>
<p>We&rsquo;ve discussed why proof of work makes sure that no block has been tampered with and even why it makes it so that everyone finding the number has about as much chance as everyone else to find it. In public blockchains you can give incentive to people in the network finding number by giving them a reward for confirming blocks. In cryptocurrency blockchains Miners get new cryptocurrency units (Bitcoins, Etherium, Doge Coins&hellip;) whenever they mine new blocks. Wait Minners? Mining? Yep, that&rsquo;s what finding that magic number is usually called in the cryptocurrency world. They use minners to create new coins and add to the supply. Minners spend those credits and move it into circulation.</p>
<h1 id="summary">Summary</h1>
<p>I hope this somehow helped you understand a blockchain a little bit more. This is by no means an in depth explination. It&rsquo;s really a TL;DR kind of thing. Nevertheless, I hope you enjoyed it.</p>
]]></content>
        </item>
        
        <item>
            <title>Goro</title>
            <link>https://victoramartinez.com/posts/goro/</link>
            <pubDate>Mon, 21 May 2018 13:36:22 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/goro/</guid>
            <description>&lt;p&gt;I know I haven&amp;rsquo;t posted in a long time, but I finally felt I needed an update in my blog. I&amp;rsquo;ve recently updated some work on my own Go library for &lt;a href=&#34;https://eventstore.org&#34;&gt;EventStore&lt;/a&gt; called &lt;a href=&#34;https://github.com/vectorhacker/goro&#34;&gt;goro&lt;/a&gt;. I made this for my own personal work and my job at &lt;a href=&#34;http://alqmy.io&#34;&gt;ALQMY&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I used to use &lt;a href=&#34;https://github.com/jetbasrawi/go.geteventstore&#34;&gt;Go.GetEventStore&lt;/a&gt; as my prefered library for working with EventStore. It was nice, but I felt it was lacking in many features and was ultimitely very cumbersome to work with, especially when it comes to reading events in a streaming fashion. I modeled my libary much like the sarama library for Kafka which has a similar api for streaming. On top of that I&amp;rsquo;ve added native support for reading streams, not only forwards, but backwards as well. This to me was a very important feature to have, as sometimes things like inlined snapshots in &lt;a href=&#34;https://martinfowler.com/eaaDev/EventSourcing.html&#34;&gt;Event Sourcing&lt;/a&gt; &lt;a href=&#34;https://martinfowler.com/eaaDev/EventSourcing.html&#34;&gt;[1]&lt;/a&gt;&lt;a href=&#34;http://microservices.io/patterns/data/event-sourcing.html&#34;&gt;[2]&lt;/a&gt;&lt;a href=&#34;https://eventstore.org/docs/event-sourcing-basics/index.html&#34;&gt;[3]&lt;/a&gt; require that you read a stream backwards.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>I know I haven&rsquo;t posted in a long time, but I finally felt I needed an update in my blog. I&rsquo;ve recently updated some work on my own Go library for <a href="https://eventstore.org">EventStore</a> called <a href="https://github.com/vectorhacker/goro">goro</a>. I made this for my own personal work and my job at <a href="http://alqmy.io">ALQMY</a>.</p>
<p>I used to use <a href="https://github.com/jetbasrawi/go.geteventstore">Go.GetEventStore</a> as my prefered library for working with EventStore. It was nice, but I felt it was lacking in many features and was ultimitely very cumbersome to work with, especially when it comes to reading events in a streaming fashion. I modeled my libary much like the sarama library for Kafka which has a similar api for streaming. On top of that I&rsquo;ve added native support for reading streams, not only forwards, but backwards as well. This to me was a very important feature to have, as sometimes things like inlined snapshots in <a href="https://martinfowler.com/eaaDev/EventSourcing.html">Event Sourcing</a> <a href="https://martinfowler.com/eaaDev/EventSourcing.html">[1]</a><a href="http://microservices.io/patterns/data/event-sourcing.html">[2]</a><a href="https://eventstore.org/docs/event-sourcing-basics/index.html">[3]</a> require that you read a stream backwards.</p>
<p>So I think I should show you how the library actually works. First things first connecting to EventStore is as simple as:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">client</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">goro</span>.<span style="color:#a6e22e">Connect</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;http://localhost:2113&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">goro</span>.<span style="color:#a6e22e">WithBasicAuth</span>(<span style="color:#e6db74">&#34;admin&#34;</span>, <span style="color:#e6db74">&#34;changeit&#34;</span>),
</span></span><span style="display:flex;"><span>    )
</span></span></code></pre></div><p>Now here is the first major difference between my library and that of Go.GetEventStore. When you connect, you initially give it the connection options such as authentication. In the future I&rsquo;ll add more options, but each option is implemented via a simple interface:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ClientOption</span> <span style="color:#66d9ef">func</span>(<span style="color:#f92672">*</span><span style="color:#a6e22e">Client</span>)
</span></span></code></pre></div><p>This enables me to add options to it arbitrarily. This is very similar to how the <a href="https://github.com/grpc/grpc-go">gRPC-Go</a> libraries add options to connections. In contrast Go.GetEventStore does this for authentication for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">client</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">goes</span>.<span style="color:#a6e22e">NewClient</span>(<span style="color:#66d9ef">nil</span>, <span style="color:#e6db74">&#34;http://youreventstore:2113&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">SetBasicAuth</span>(<span style="color:#e6db74">&#34;admin&#34;</span>, <span style="color:#e6db74">&#34;changeit&#34;</span>)
</span></span></code></pre></div><p>I find this partial builder pattern kind of confusing and very fragile. Besdies, I&rsquo;m usually very averse to the whole getter/setter pattern in general, but that&rsquo;s a topic for another blog post.</p>
<p>Another big thing I wanted was better streaming. I&rsquo;m a big fan of using Go&rsquo;s channel feature to manage concurrency and to iterate through streaming data. It is very easy to iterate over a channel as if it where an array:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stream</span> <span style="color:#f92672">:=</span> make(<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">string</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">go</span> <span style="color:#66d9ef">func</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">stream</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">message</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stream</span> <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;hello&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">stream</span> <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;wow&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>close(<span style="color:#a6e22e">stream</span>)
</span></span></code></pre></div><p>I think this is very nice, simple, clean, and elegant way of handling concurrency. There&rsquo;s also no risk of the channel giving an error when getting messages in this model because the go for loop automatically breaks when the channel is closed. So in that fashion, I modeled my subscriptions for EventStore in this manner:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">client</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">goro</span>.<span style="color:#a6e22e">Connect</span>(<span style="color:#e6db74">&#34;http://localhost:2113&#34;</span>, <span style="color:#a6e22e">goro</span>.<span style="color:#a6e22e">WithBasicAuth</span>(<span style="color:#e6db74">&#34;admin&#34;</span>, <span style="color:#e6db74">&#34;changeit&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ctx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">events</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">catchupSubscription</span>.<span style="color:#a6e22e">Subscribe</span>(<span style="color:#a6e22e">ctx</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> <span style="color:#a6e22e">event</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">events</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Each stream message has a few things inside it that help you manage the stream. This includes the event, an error, and some acknowledger for when you have persistent subscriptions.</p>
<p>Streaming style subscriptions isn&rsquo;t the only way to read events, you can also read arbitrarily using a reader:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">reader</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">FowardsReader</span>(<span style="color:#e6db74">&#34;messages&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">events</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reader</span>.<span style="color:#a6e22e">Read</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    panic(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>as you can see, you can specify very easily the direction in which you want to read, this to me was very important.</p>
<h2 id="improvements">Improvements:</h2>
<p>I&rsquo;m still adding things to this library, and I welcome any pull requests that want to add features. A few of the features I want to add are:</p>
<ul>
<li>Support for the <a href="https://eventstore.org/docs/projections/api/index.html">Projections API</a></li>
<li>Support for handling <a href="https://eventstore.org/docs/http-api/swagger/Users.html">users</a>.</li>
</ul>
<p>These should be simple to implement, but I&rsquo;ve been to lazy to build them yet and right now it&rsquo;s not a pressing concern.</p>
]]></content>
        </item>
        
        <item>
            <title>Amazon Key</title>
            <link>https://victoramartinez.com/posts/amazon-key/</link>
            <pubDate>Sun, 26 Nov 2017 23:20:47 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/amazon-key/</guid>
            <description>&lt;p&gt;&lt;img src=&#34;https://victoramartinez.com/images/amazon-key.jpeg&#34; alt=&#34;Amazon Key&#34;&gt;&lt;/p&gt;
&lt;p&gt;So Amazon &lt;a href=&#34;https://www.recode.net/2017/10/25/16538828/amazon-key-in-home-delivery-prime-camera-lock&#34;&gt;recently announced&lt;/a&gt; a new program called &lt;a href=&#34;https://en.wikipedia.org/wiki/Amazon_Key&#34;&gt;Amazon Key&lt;/a&gt;. This program would let deliverymen enter the house of people who have purchased the program. I&amp;rsquo;m really uncomfortable with this idea. For one thing, I don&amp;rsquo;t want Amazon, much less any other giant company, controlling entrance to my home. Second, this just feels like a whole new invasion of privacy.&lt;/p&gt;
&lt;p&gt;This is just part of a much bigger problem. Silicon Valley companies are becoming so arrogant and negligent, and they&amp;rsquo;re giving me more and more reason to stop trusting them. Why would Amazon think that I would trust them with the security of my home? I say no.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p><img src="/images/amazon-key.jpeg" alt="Amazon Key"></p>
<p>So Amazon <a href="https://www.recode.net/2017/10/25/16538828/amazon-key-in-home-delivery-prime-camera-lock">recently announced</a> a new program called <a href="https://en.wikipedia.org/wiki/Amazon_Key">Amazon Key</a>. This program would let deliverymen enter the house of people who have purchased the program. I&rsquo;m really uncomfortable with this idea. For one thing, I don&rsquo;t want Amazon, much less any other giant company, controlling entrance to my home. Second, this just feels like a whole new invasion of privacy.</p>
<p>This is just part of a much bigger problem. Silicon Valley companies are becoming so arrogant and negligent, and they&rsquo;re giving me more and more reason to stop trusting them. Why would Amazon think that I would trust them with the security of my home? I say no.</p>
]]></content>
        </item>
        
        <item>
            <title>Github Pages</title>
            <link>https://victoramartinez.com/posts/github-pages/</link>
            <pubDate>Sun, 26 Nov 2017 01:06:20 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/github-pages/</guid>
            <description>&lt;p&gt;I&amp;rsquo;m hosting this blog using Github pages (because I&amp;rsquo;m cheap.) You can browser through the source code &lt;a href=&#34;https://github.com/vectorhacker/victoramartinez.com&#34;&gt;here&lt;/a&gt;. I&amp;rsquo;m using &lt;a href=&#34;https://gohugo.io&#34;&gt;Hugo&lt;/a&gt; to generate the static site. Overall it&amp;rsquo;s pretty great.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p>I&rsquo;m hosting this blog using Github pages (because I&rsquo;m cheap.) You can browser through the source code <a href="https://github.com/vectorhacker/victoramartinez.com">here</a>. I&rsquo;m using <a href="https://gohugo.io">Hugo</a> to generate the static site. Overall it&rsquo;s pretty great.</p>
]]></content>
        </item>
        
        <item>
            <title>Net Neutrality Opinion</title>
            <link>https://victoramartinez.com/posts/net-neutrality-opinion/</link>
            <pubDate>Sun, 26 Nov 2017 00:44:22 -0400</pubDate>
            
            <guid>https://victoramartinez.com/posts/net-neutrality-opinion/</guid>
            <description>&lt;p&gt;&lt;img src=&#34;https://victoramartinez.com/images/fight-net.jpg&#34; alt=&#34;Fight For Net Neutrality!&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;background&#34;&gt;Background&lt;/h3&gt;
&lt;p&gt;This December, the FCC will vote on wether to keep or reverse &lt;a href=&#34;http://transition.fcc.gov/Reports/1934new.pdf&#34;&gt;Title II of the Communications Act&lt;/a&gt; of 1934 in regards to ISPs. This decision will affect the way the internet works in the United States and if reversed, would give ISPs incentive to give preferential treatment of some data packets over others, among many other things that they could do. These rules are with the intent of creating a level playing field within the internet and keeping the internet free and open.&lt;/p&gt;</description>
            <content type="html"><![CDATA[<p><img src="/images/fight-net.jpg" alt="Fight For Net Neutrality!"></p>
<h3 id="background">Background</h3>
<p>This December, the FCC will vote on wether to keep or reverse <a href="http://transition.fcc.gov/Reports/1934new.pdf">Title II of the Communications Act</a> of 1934 in regards to ISPs. This decision will affect the way the internet works in the United States and if reversed, would give ISPs incentive to give preferential treatment of some data packets over others, among many other things that they could do. These rules are with the intent of creating a level playing field within the internet and keeping the internet free and open.</p>
<p>In a nutshell, Net neutrality simply states that all internet traffic ought to be treated equally and delivered equally. In essence, ISPs  can’t block, throttle, nor speed up content for companies that pay.</p>
<h3 id="title-ii">Title II</h3>
<p>Title II has to do with what are called “common carriers”. These include utilities like water, electricity, and land-line phones. In 2015 the Open n Internet Order made it so that ISPs fall under Title II, before that they were classified under Title I.</p>
<p>Why is this important? Without this classification, the FCC would have no authority to enforce net neutrality rules and would be essentially powerless if an ISP decides to <a href="https://consumerist.com/2014/02/23/netflix-agrees-to-pay-comcast-to-end-slowdown/">throttle your connection to Netflix</a>.</p>
<h3 id="argument-against-title-ii-and-why-theyre-probably-wrong">Argument against Title II and why they’re probably wrong</h3>
<p>The main argument against Title II is that the regulation hurts ISPs ability to innovate and curbs investment. Wether or not that is true, it’s really up for debate. The current FCC Chairman Ajit Pai, who voted against the 2015 Open Internet Order said:</p>
<blockquote>
<p><em>“This burdensome regulation has failed consumers and businesses alike. In the two years after the FCC’s decision, broadband network investment dropped more than 5.6 percent—the first time a decline has happened outside of a recession. If the current rules are left in place, millions of Americans who are on the wrong side of the digital divide would have to wait years to get more broadband.”</em></p></blockquote>
<p>There is reason to believe, however, that the net neutrality rules will not hurt ISPs investment. “We found that not a single publicly traded US ISP ever told its investors (or the SEC) that Title II negatively impacted its own investments specifically” as said in a <a href="https://www.freepress.net/sites/default/files/resources/internet-access-and-online-video-markets-are-thriving-in-title-II-era.pdf">report issued by the Free Press</a>. Many ISPs have told their investors that <a href="http://www.dslreports.com/shownews/ISPs-Tell-Investors-Title-II-Wont-Hurt-Them-In-The-Slightest-131865">Title II won’t hurt them in the slightest</a>.  More over, there have been many disputes over the claims made by Pai, and some analysis shows that ISP investment has <a href="https://arstechnica.com/information-technology/2017/05/title-ii-hasnt-hurt-network-investment-according-to-the-isps-themselves/">actually</a> <a href="http://www.cmcsa.com/releasedetail.cfm?ReleaseID=1023210">increased</a> and that it continues. You can read the full report, <a href="https://www.freepress.net/sites/default/files/resources/internet-access-and-online-video-markets-are-thriving-in-title-II-era.pdf">here</a>.</p>
<p>So really it seams that the internet is thriving under Title II.</p>
<h3 id="data-caps">Data caps</h3>
<p>Many ISPs in the United States put in place what are called <a href="https://en.wikipedia.org/wiki/Bandwidth_cap">Data Caps or Bandwidth Caps</a>. These are artificial restrictions on transfer of data over a network. This mechanism is in place to limit customer usage of their services. ISPs assert that these are necessary to provide “fair” service to their users.</p>
<p>According to StopTheCap.com.</p>
<blockquote>
<p>…former FCC chairman Julius Genachowski defended the practice, claiming it would bring lower prices to light users, spur “innovation”, and enable consumer choice.</p></blockquote>
<p>This measure is often criticized as it is becoming increasingly unneeded, mostly because infrastructure is becoming cheaper to buy and maintain in order to increase capacity. There have also been assertions that ISPs who own pay television services keep these caps in order to protect this service.</p>
<p>It is more likely that data caps are in place to maximize ISP profit and not because of the limits of their systems. Comcast, for example, can more than pay for not having <a href="https://www.cio.com/article/3075975/internet-service-providers/what-big-isps-dont-want-you-to-know-about-data-caps.html">limits on data</a>. A <a href="http://www.theverge.com/smart-home/2015/11/7/9687976/comcast-data-caps-are-not-about-fixing-network-congestion">leaked memo</a> from Comcast even went so far as to state that the data caps are not in place because of network performance. Many ISP CEOs have even said that as their costs decrease for maintaining broadband there is really no reason to have them as the days of keeping up with users data usage is basically over. As a St. Louis broadband says companies don’t have to spend a lot to keep up with customers’ data demands. “Those days are basically over.” <a href="http://time.com/money/4360431/internet-data-caps-bogus-ploys/">CEOs: Data Caps Are Bogus Ploys to Make Internet Seem Scarce | Money</a></p>
<p>But there’s hope, some internet companies in the United States are either raising data caps or removing them entirely. And Netflix is <a href="https://www.bloomberg.com/news/articles/2012-06-27/netflix-wants-help-from-u-s-against-cable-data-caps">asking</a> lawmakers to prevent ISPs from putting these caps in place. But it is still an uphill battle, as Comcast and many others keep <a href="https://www.consumerreports.org/telecom-services/how-easy-to-burn-through-1TB-data-cap/">putting these in place</a>.</p>
<h3 id="whats-ahead">What’s ahead</h3>
<p>If Net Neutrality is reversed, specifically the classification of ISPs under Title II, ISPs would not have much incentive in keeping data service fair. And we’ve already seen that they limit your data usage just to please their needs of profit and/or to protect their other services like paid television. On December the FCC will vote and they can determine the future of the internet for America. Voice your opinion <a href="www.gofccyourself.com">here</a> GoFccYourself.com and make sure to tell them that you want ISPs to stay under Title II.</p>
<h3 id="sources">Sources</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Net_neutrality#EU_and_net_neutrality">https://en.wikipedia.org/wiki/Net_neutrality#EU_and_net_neutrality</a></li>
<li><a href="http://www.dslreports.com/shownews/ISPs-Tell-Investors-Title-II-Wont-Hurt-Them-In-The-Slightest-131865">ISPs Tell Investors Title II Won’t Hurt Them In The Slightest | DSLReports, ISP Information</a></li>
<li><a href="https://www.freepress.net/sites/default/files/resources/internet-access-and-online-video-markets-are-thriving-in-title-II-era.pdf">https://www.freepress.net/sites/default/files/resources/internet-access-and-online-video-markets-are-thriving-in-title-II-era.pdf</a></li>
<li><a href="https://arstechnica.com/information-technology/2017/05/title-ii-hasnt-hurt-network-investment-according-to-the-isps-themselves/">https://arstechnica.com/information-technology/2017/05/title-ii-hasnt-hurt-network-investment-according-to-the-isps-themselves/</a></li>
<li><a href="https://arstechnica.com/tech-policy/2017/07/verizons-throttling-of-video-should-be-investigated-by-fcc-petition-says/">https://arstechnica.com/tech-policy/2017/07/verizons-throttling-of-video-should-be-investigated-by-fcc-petition-says/</a></li>
<li><a href="https://www.usatoday.com/story/tech/columnist/shinal/2016/03/29/netflix-throttling-shows-net-neutrality-life-support-column/82388890/">https://www.usatoday.com/story/tech/columnist/shinal/2016/03/29/netflix-throttling-shows-net-neutrality-life-support-column/82388890/</a></li>
<li><a href="https://consumerist.com/2014/02/23/netflix-agrees-to-pay-comcast-to-end-slowdown/">https://consumerist.com/2014/02/23/netflix-agrees-to-pay-comcast-to-end-slowdown/</a></li>
<li><a href="https://www.dailydot.com/layer8/what-is-title-ii-net-neutrality-fcc/">https://www.dailydot.com/layer8/what-is-title-ii-net-neutrality-fcc/</a></li>
<li><a href="https://www.consumerreports.org/telecom-services/how-easy-to-burn-through-1TB-data-cap/">https://www.consumerreports.org/telecom-services/how-easy-to-burn-through-1TB-data-cap/</a></li>
<li><a href="https://www.bloomberg.com/news/articles/2016-01-28/comcast-draws-customer-ire-by-putting-netflix-addicts-on-a-meter">https://www.bloomberg.com/news/articles/2016-01-28/comcast-draws-customer-ire-by-putting-netflix-addicts-on-a-meter</a></li>
<li><a href="https://www.bloomberg.com/news/articles/2012-06-27/netflix-wants-help-from-u-s-against-cable-data-caps">https://www.bloomberg.com/news/articles/2012-06-27/netflix-wants-help-from-u-s-against-cable-data-caps</a></li>
<li><a href="https://arstechnica.com/information-technology/2014/05/comcast-plans-data-caps-for-all-customers-in-5-years-could-be-500gb/">https://arstechnica.com/information-technology/2014/05/comcast-plans-data-caps-for-all-customers-in-5-years-could-be-500gb/</a></li>
<li><a href="http://time.com/money/4360431/internet-data-caps-bogus-ploys/">CEOs: Data Caps Are Bogus Ploys to Make Internet Seem Scarce | Money</a></li>
<li><a href="https://www.cio.com/article/3075975/internet-service-providers/what-big-isps-dont-want-you-to-know-about-data-caps.html">What big ISPs don’t want you to know about data caps | CIO</a></li>
<li><a href="http://money.cnn.com/2015/10/21/technology/unlimited-data/">http://money.cnn.com/2015/10/21/technology/unlimited-data/</a></li>
<li><a href="https://en.wikipedia.org/wiki/Bandwidth_cap">https://en.wikipedia.org/wiki/Bandwidth_cap</a></li>
<li><a href="https://www.usatoday.com/story/tech/2012/10/01/internet-data-cap/1595683/">https://www.usatoday.com/story/tech/2012/10/01/internet-data-cap/1595683/</a></li>
<li><a href="http://bgr.com/2015/11/19/comcast-data-cap-2015-bad-for-us-all/">http://bgr.com/2015/11/19/comcast-data-cap-2015-bad-for-us-all/</a></li>
<li><a href="http://www.makeuseof.com/tag/data-caps-exist-can-bypass/">http://www.makeuseof.com/tag/data-caps-exist-can-bypass/</a></li>
<li><a href="http://stopthecap.com/">Stop the Cap! Stop the Cap! · Promoting Better Broadband, Fighting Data Caps and Usage-Based Billing</a></li>
</ul>
]]></content>
        </item>
        
    </channel>
</rss>
